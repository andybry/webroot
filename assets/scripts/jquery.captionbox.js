var STCONST_FILENAME="jquery.captionbox.js",STCONST_WS_UPDATE_TRANSCRIPT="/transactions/update_from_editor",STCONSTS_WSCREDS_BITLY_LOGIN="speakertext",STCONSTS_WSCREDS_BITLY_APIKEY="R_2274af29d71349021399a6ee1191ab6b",STCONST_CLASS_SHARE_BUTTON="STxShare",STCONST_CLASS_SHARE_FACEBOOK="STfacebookShare",STCONST_CLASS_SHARE_TWITTER="STtwitterShare",STCONST_CLASS_SHARE_URL="STurlShare",STCONST_QUERY_PLAYER_QUOTELINK="STQL",STCONST_TEXT_BAR_SEARCH="Search this transcript...",STCONST_TEXT_BAR_LOGOLINK="http://speakertext.com/?ref=itp",STCONST_TEXT_BAR_AUTOSCROLL="AUTO SCROLL",STCONST_TEXT_BAR_SHOWTEXT="EXPAND TRANSCRIPT",STCONST_TEXT_EDIT_SAVE="Save",STCONST_TEXT_EDIT_CANCEL="Cancel",STCONST_TEXT_MESSAGE_EDIT="<p>Just start typing to edit the transcript.</p>",STCONST_TEXT_MESSAGE_SAVING="<p>Saving Transcript...</p>",STCONST_TEXT_MESSAGE_SAVEOK="<h1>Transcript Received!</h1><p>Your transcript has been queued for processing and should be visible in a few moments. <a href='/library'>Return to library &raquo</a></p>",STCONST_TEXT_MESSAGE_SAVEERROR="<h1>Error</h1><p>Your transcript could not be saved at this time. Please try again in a few moments.</p>",STCONST_TEXT_SHARE_UNSELECTED="<strong>Link to a video quote</strong><br>To start, select some text from the transcript<br>",STCONST_TEXT_SHARE_HIGHLIGHTED="<strong>Share the selected quote</strong><br>The video will start playing at this quote</a><br>",STCONST_TEXT_SHARE_SELECTED="<strong>Share the current quote</strong><br>The video will start playing at this quote</a><br>",STCONST_TEXT_SHARE_BUTTONS="<a class='"+STCONST_CLASS_SHARE_TWITTER+" "+STCONST_CLASS_SHARE_BUTTON+"' onmousedown=\"stjQuery(this).STcaptureQuoteLink()\" onclick=\"if(stjQuery(this).data(STCONST_DATAKEY_QUOTELINK_TEXT) != '') { temp = window.open('','_blank','width=550,height=420'); stjQuery(this).STtwitterShare(temp); }\"></a><a class='"+STCONST_CLASS_SHARE_FACEBOOK+" "+STCONST_CLASS_SHARE_BUTTON+"' onmousedown=\"stjQuery(this).STcaptureQuoteLink()\" onclick=\"if(stjQuery(this).data(STCONST_DATAKEY_QUOTELINK_TEXT) != '') { temp = window.open('','_blank'); stjQuery(this).STfacebookShare(temp); }\"></a><a class='"+STCONST_CLASS_SHARE_URL+" "+STCONST_CLASS_SHARE_BUTTON+'\' onmousedown="stjQuery(this).STcaptureQuoteLink()" onclick="if(stjQuery(this).data(STCONST_DATAKEY_QUOTELINK_TEXT) != \'\') { stjQuery(this).STurlShare(); }"></a><br>',STCONST_TEXT_MESSAGE_SHAREURL_BEGIN="<h1>",STCONST_TEXT_MESSAGE_SHAREURL_END="</h1><p>Copy and share this URL to link back to this moment of the video.</p>",STCONST_TEXT_MESSAGE_COPY="<strong>QuoteLink Created!</strong><p>When you paste this text, it will link back to this moment in the video. <a href='http://speakertext.com/what' target='_blank'>More&nbsp;&raquo;</a></p>",STCONST_TEXT_TRANSCRIPT_LOADING="<div>The transcript for this video is loading.</div>",STCONST_TEXT_TRANSCRIPT_UNAVAILABLE="<div>The transcript for this video is unavailable.</div>",STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX="STtranscriptContent",STCONST_PLAYER_TRANSCRIPTEMBED_PREFIX="STtranscriptEmbed",STCONST_PLAYER_IGNORE_THRESHOLD=3000,STCONST_CLASS_PLAYER="STplayer",STCONST_CLASS_UNINITIALIZED="STplayerUninitialized",STCONST_CLASS_EMBEDDED="STplayerEmbedded",STCONST_CLASS_NICEBUTTON="nicebutton",STCONST_CLASS_EDITOR="STeditor",STCONST_CLASS_VIDEOPLAYER="STvideoPlayer",STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT="STdisplayWithTranscript",STCONST_CLASS_PLAYER_TRANSCRIPTPANE="STtranscriptPane",STCONST_CLASS_PLAYER_TRANSCRIPTWRAPPER="STtranscriptWrapper",STCONST_CLASS_PLAYER_BAREBONES="STplayerBarebones",STCONST_CLASS_PLAYER_SHAREPANE="STsharePane",STCONST_CLASS_PLAYER_SHAREPANE_ACTIVE="STsharePaneActive",STCONST_CLASS_PLAYER_SHAREPANE_HIGHLIGHT="STsharePaneHighlight",STCONST_CLASS_PLAYER_SHAREPANE_TEXT="STsharePaneText",STCONST_CLASS_PLAYER_COPYFEEDBACK="STsharePaneCopyFeedback",STCONST_CLASS_PLAYER_TRANSCRIPTDISPLAY="STtranscriptDisplay",STCONST_CLASS_PLAYER_TRANSCRIPTSTATUS="STtranscriptStatus",STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT="STtranscriptContent",STCONST_CLASS_PLAYER_SEARCH="STsearch",STCONST_CLASS_PLAYER_SEARCHFIELD="STsearchField",STCONST_CLASS_PLAYER_SEARCHPREVBUTTON="STsearchPrevButton",STCONST_CLASS_PLAYER_SEARCHNEXTBUTTON="STsearchNextButton",STCONST_CLASS_PLAYER_AUTOSCROLL="STautoScroll",STCONST_CLASS_PLAYER_SHOWTEXT="STshowText",STCONST_CLASS_PLAYER_LOGO="STlogo",STCONST_CLASS_PLAYER_CURRENTCONTENT="STcurrentContent",STCONST_CLASS_PLAYER_SEARCHMATCH="STsearchMatch",STCONST_CLASS_PLAYER_BASE="STplayerBase",STCONST_CLASS_PLAYER_BASELEFT="STplayerBaseLeft",STCONST_CLASS_PLAYER_BASERIGHT="STplayerBaseRight",STCONST_CLASS_PLAYER_HANDLE="STplayerHandle",STCONST_CLASS_PLAYER_SCROLLBAR="STscrollBar",STCONST_CLASS_PLAYER_SCROLLUP="STscrollUp",STCONST_CLASS_PLAYER_SCROLLDOWN="STscrollDown",STCONST_CLASS_PLAYER_SCROLLVISIBLE="STscrollVisible",STCONST_CLASS_PLAYER_SCROLLTOP="STscrollTop",STCONST_CLASS_PLAYER_SCROLLBOTTOM="STscrollBottom",STCONST_CLASS_PLAYER_BAR="STbar",STCONST_CLASS_MESSAGEPANE="STmessagePane",STCONST_CLASS_COPY_FEEDBACK="STcopyFeedback",STCONST_CLASS_PLAYER_FONTSIZEBUTTON="STfontSizeButton",STCONST_CLASS_EDIT_SAVE="STsaveButton",STCONST_CLASS_EDIT_CANCEL="STcancelButton",STCONST_CLASS_EDIT_EMPTY="STemptyContentEdit",STCONST_CLASS_PLAYER_EMBEDOVERLAY="SToverlay",STCONST_CLASS_PLAYER_EMBEDWRAPPER="STembedWrapper",STCONST_CLASS_PLAYER_AUTOSCROLL_ON="on",STCONST_CLASS_PLAYER_AUTOSCROLL_OFF="off",STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING="STtranscriptLoading",STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE="visibleTranscript",STCONST_CLASS_PLAYER_SEARCHEMPTY="empty",STCONST_CLASS_PLAYER_SMALLFONT="smallFont",STCONST_CLASS_PLAYER_MEDIUMFONT="mediumFont",STCONST_CLASS_PLAYER_LARGEFONT="largeFont",STCONST_EVENT_TRANSCRIPT_LOADED="transcriptLoaded",STCONST_EVENT_PLAYER_SHOW="showPlayer",STCONST_EVENT_PLAYER_HIDE="hidePlayer",STCONST_EVENT_PLAYER_SEARCH="search",STCONST_EVENT_PLAYER_SEARCHNEXT="searchNext",STCONST_EVENT_PLAYER_SEARCHPREV="searchPrev",STCONST_EVENT_CONTENT_CLICKED="contentClicked",STCONST_EVENT_CONTENT_SELECT="contentSelect",STCONST_EVENT_CONTENT_COPY="contentCopy",STCONST_EVENT_CONTENT_DESELECT="contentDeselect",STCONST_DATAKEY_VIDEOPLAYERID="STvideoplayerID",STCONST_DATAKEY_VIDEOPLAYER="STvideoPlayer",STCONST_DATAKEY_TRANSCRIPTID="STtranscriptID",STCONST_DATAKEY_PLAYERQUEUE="STplayerQueue",STCONST_DATAKEY_PLAYER_DISABLED="STplayerDisabled",STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL="STautoScroll",STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID="STcurrentContentID",STCONST_DATAKEY_TRANSCRIPT_SEARCHMATCHES="STsearchMatches",STCONST_DATAKEY_TRANSCRIPT_SEARCHTERMS="STsearchTerms",STCONST_DATAKEY_TRANSCRIPT_IGNOREPROGRESS="STtranscriptIgnoreProgress",STCONST_DATAKEY_CONFIG="STconfig",STCONST_DATAKEY_QUOTELINK_TEXT="STquoteLinkText",STCONST_DATAKEY_QUOTELINK_CONTENTID="STquoteLinkContentID",STCONST_DATAKEY_SHAREURL_TIMEOUT="STshareUrlTimeout",STCONST_DATAKEY_EDITMESSAGE_SHOWN="STeditMessageShown",STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF=0,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON=1,STCONST_CONFIG_INITIALSTATE_OPEN="open",STCONST_CONFIG_INITIALSTATE_CLOSED="closed",STCONST_CONFIG_EDITENABLED_OFF="off",STCONST_CONFIG_EDITENABLED_ON="on",STCONST_CONFIG_EMBEDSTYLE_OVERLAY="overlay",STCONST_CONFIG_EMBEDSTYLE_EMBED="embed";if(typeof window.jQuery!="undefined"){var versionString=window.jQuery().jquery;versionString.indexOf("1.3")==0||versionString.indexOf("1.4")==0||versionString.indexOf("1.5")==0||versionString.indexOf("1.6")==0||versionString.indexOf("1.7")==0?window.stjQuery=window.jQuery:console&&console.error&&console.error("CAPTIONBOX: Must load jQuery 1.3+ before loading CaptionBox!")}else{console&&console.error&&console.error("CAPTIONBOX: Must load jQuery 1.3+ before loading CaptionBox!")}(function(b){function i(){this.timestamp=this.id=0;this.text=""}function j(){this.task=this.videoID=this.transcriptID=0;this.hash="";this.content=[]}var l={},k={},d=0;j.prototype.getContentByTimestamp=function(f){if(this.content.length==0){return null}previousContent=this.content[0];for(var g=0;g<this.content.length;g++){var e=this.content[g];if(e.timestamp==f){return e}else{if(e.timestamp>f){break}}previousContent=e}return previousContent};j.prototype.getContentByID=function(f){for(var g=0;g<this.content.length;g++){var e=this.content[g];if(e.id==f){return e}}return null};j.prototype.updateContentByID=function(f,g){for(var e=0;e<this.content.length;e++){if(this.content[e].id==f){this.content[e].text=g;return}}return null};j.prototype.search=function(g){for(var m=[],g=g.toLowerCase(),e=0;e<this.content.length;e++){var h=this.content[e];h.text.toLowerCase().search(g)!=-1&&m.push(h)}return m};b.fn.extend({hasCaptionBox:function(){return b(this).hasClass(STCONST_CLASS_VIDEOPLAYER)},captionBox:function(e){var a={minHeight:30,defaultHeight:210,transcriptPath:"",matchVideoWidth:true,initialState:STCONST_CONFIG_INITIALSTATE_OPEN,editEnabled:STCONST_CONFIG_EDITENABLED_OFF,embedStyle:STCONST_CONFIG_EMBEDSTYLE_EMBED};typeof STglobalSettings!="undefined"&&b.extend(a,STglobalSettings);e&&b.extend(a,e);this.each(function(){if(b(this).hasCaptionBox()){return true}++d;b(this).addClass(STCONST_CLASS_VIDEOPLAYER);var aq=b("#"+(a.preEmbedID||STCONST_PLAYER_TRANSCRIPTEMBED_PREFIX+"_"+a.videoPlayer.cbHostId+"_"+a.videoPlayer.videoId));if(aq.length==0){return false}else{aq.removeClass(STCONST_CLASS_PLAYER_BAREBONES);var ap=aq.STembedWrapper().html(),ao="";ao+="<div class='"+STCONST_CLASS_PLAYER_EMBEDWRAPPER+"'>";ao+="  <div class='"+STCONST_CLASS_PLAYER_SHAREPANE+" "+STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT+"'>";ao+="    <span class='"+STCONST_CLASS_PLAYER_SHAREPANE_TEXT+"'>"+STCONST_TEXT_SHARE_UNSELECTED+"</span>"+STCONST_TEXT_SHARE_BUTTONS;ao+="  </div>";ao+="  <div class='"+STCONST_CLASS_PLAYER_TRANSCRIPTPANE+"'>";ao+="    <div class='"+STCONST_CLASS_PLAYER_SCROLLBAR+"'>";ao+="      <div class='"+STCONST_CLASS_PLAYER_SCROLLUP+"'></div>";ao+="      <div class='"+STCONST_CLASS_PLAYER_SCROLLVISIBLE+"'>";ao+="        <div class='"+STCONST_CLASS_PLAYER_SCROLLTOP+"'></div>";ao+="        <div class='"+STCONST_CLASS_PLAYER_SCROLLBOTTOM+"'></div>";ao+="      </div>";ao+="      <div class='"+STCONST_CLASS_PLAYER_SCROLLDOWN+"'></div>";ao+="    </div>";ao+="    <div class='"+STCONST_CLASS_PLAYER_TRANSCRIPTWRAPPER+"'>";ao+="     <div class='"+STCONST_CLASS_PLAYER_TRANSCRIPTDISPLAY+"'>";ao+=ap;ao+="      </div>";ao+="      <div class='"+STCONST_CLASS_PLAYER_TRANSCRIPTSTATUS+"'></div>";ao+="    </div>";ao+="  </div>";ao+="  <div class='"+STCONST_CLASS_PLAYER_BASE+"'>";ao+="    <div class='"+STCONST_CLASS_PLAYER_BASERIGHT+"'></div>";ao+="    <div class='"+STCONST_CLASS_PLAYER_BASELEFT+"'></div>";ao+="    <div class='"+STCONST_CLASS_PLAYER_HANDLE+"'></div>";ao+="  </div>";ao+="  <div class='"+STCONST_CLASS_MESSAGEPANE+"'></div>";ao+="</div>";aq.STembedWrapper().remove();aq.append(ao);ao="";ao+="<input type='text' class='"+STCONST_CLASS_PLAYER_SEARCHFIELD+" "+STCONST_CLASS_PLAYER_SEARCHEMPTY+"'/>";ao+="<div class='"+STCONST_CLASS_PLAYER_SEARCHPREVBUTTON+" "+STCONST_CLASS_PLAYER_SEARCHEMPTY+" "+STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT+"'></div>";ao+="<div class='"+STCONST_CLASS_PLAYER_SEARCHNEXTBUTTON+" "+STCONST_CLASS_PLAYER_SEARCHEMPTY+" "+STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT+"'></div>";ao+="<div class='"+STCONST_CLASS_PLAYER_FONTSIZEBUTTON+" "+STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT+"'></div>";ao+="<div class='"+STCONST_CLASS_PLAYER_AUTOSCROLL+" "+STCONST_CLASS_PLAYER_DISPLAYWITHTRANSCRIPT+"'>"+STCONST_TEXT_BAR_AUTOSCROLL+"</div>";ao+="<div class='"+STCONST_CLASS_PLAYER_SHOWTEXT+"'>"+STCONST_TEXT_BAR_SHOWTEXT+"</div>";aq.STbar().append(ao);a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&(ao="<a class='"+STCONST_CLASS_EDIT_SAVE+" "+STCONST_CLASS_NICEBUTTON+"' value='"+STCONST_TEXT_EDIT_SAVE+"'>"+STCONST_TEXT_EDIT_SAVE+"</a>",aq.append(ao),aq.STtranscriptWrapper().find("."+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT).attr("contentEditable","true"))}a.embedStyle==STCONST_CONFIG_EMBEDSTYLE_OVERLAY&&aq.addClass(STCONST_CLASS_PLAYER_EMBEDOVERLAY);b(this).attr("id")||b(this).attr("id",STCONST_CLASS_VIDEOPLAYER+d);k[b(this).attr("id")]=aq;aq.data(STCONST_DATAKEY_VIDEOPLAYERID,b(this).attr("id"));aq.data(STCONST_DATAKEY_VIDEOPLAYER,a.videoPlayer);var an=aq.STtranscriptDisplay(),am=aq.STtranscriptPane(),al=aq.STtranscriptWrapper(),ap=aq.STembedWrapper(),ak=aq.STsharePane(),V=aq.STscrollVisible();aq.STplayerHandle();var aj=aq.STplayerBase(),J=aq.STautoScrollButton(),u=aq.STtranscriptShowButton(),ai=aq.STsearchField(),ag=aq.STsearchNextButton(),ae=aq.STsearchPrevButton(),h=aq.STfontSizeButton(),ao=aq.STmessagePane();ai.val(STCONST_TEXT_BAR_SEARCH);a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&(ak.remove(),aq.addClass(STCONST_CLASS_EDITOR));al.attr("tabindex",100);an.bind("mouseup",function(){STgetSelectedText()!=""&&b(this).trigger(STCONST_EVENT_CONTENT_SELECT)});a.editEnabled==STCONST_CONFIG_EDITENABLED_OFF&&am.bind("copy",function(){var g=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0),g=b(g).STtranscript(),o=null;if(typeof window.getSelection!="undefined"){var p=window.getSelection();if(p.toString()){if(typeof p.setBaseAndExtent!="undefined"){var m=p.getRangeAt(0),o=m.cloneRange();o.collapse(true);o=o.startContainer;typeof b(o).attr("id")=="undefined"&&(o=b(o).parent());var o=b(o).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length),o=g.getContentByID(o),g=g.transcriptID,g=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+g,o.timestamp),n=document.createElement("div");b(n).css("position","absolute");b(n).css("left","-10000px");g="<a href='"+g+"'>"+b(m.cloneContents()).text()+"</a>";b(n).html(g);b(document.body).append(n);g=document.createRange();g.selectNode(n);p.removeAllRanges();p.addRange(g);window.setTimeout(function(){b(n).remove();window.getSelection().setBaseAndExtent(m.startContainer,m.startOffset,m.endContainer,m.endOffset)},0)}else{p=window.getSelection(),m=p.getRangeAt(0),o=m.cloneRange(),o.collapse(true),o=o.startContainer,typeof b(o).attr("id")=="undefined"&&(o=b(o).parent()),o=b(o).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length),o=g.getContentByID(o),g=g.transcriptID,g=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+g,o.timestamp),n=document.createElement("a"),b(n).attr("href",g),b(n).text(b(m.cloneContents()).text()),b(document.body).append(n),g=document.createRange(),g.selectNode(n),p.removeAllRanges(),p.addRange(g),window.setTimeout(function(){b(n).remove();p.removeAllRanges();p.addRange(m)},0)}}}else{if(document.selection){m=document.selection.createRange(),o=document.selection.createRange(),o.collapse(true),o=o.parentElement(),o=b(o).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length),o=g.getContentByID(o),g=g.transcriptID,g=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+g,o.timestamp),n=document.createElement("div"),b(n).css("visibility","hidden"),g="<a href='"+g+"'>"+m.htmlText+"</a>",b(n).html(g),b(document.body).append(n),g=document.body.createTextRange(),g.moveToElementText(n),g.select(),window.setTimeout(function(){m.select();b(n).remove()},0)}}b(this).trigger(STCONST_EVENT_CONTENT_COPY)});a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&aq.STsaveButton().click(function(){b(this).addClass("disabled");b(this).html("Saving...");aq.STshowMessage(STCONST_TEXT_MESSAGE_SAVING);var c=b(this).STtranscript();b.ajax({type:"PUT",url:STCONST_WS_UPDATE_TRANSCRIPT,data:{hash:c.hash,content:c.content},success:function(){aq.STsaveButton().removeClass("disabled");aq.STsaveButton().html("Save");aq.STshowMessage(STCONST_TEXT_MESSAGE_SAVEOK);window.setTimeout(function(){b(aq).SThideMessage()},8000)},error:function(){aq.STsaveButton().removeClass("disabled");aq.STsaveButton().html("Save");aq.STshowMessage(STCONST_TEXT_MESSAGE_SAVEERROR);window.setTimeout(function(){b(aq).SThideMessage()},5000)}})});h.click(function(){aq.hasClass(STCONST_CLASS_PLAYER_SMALLFONT)?(aq.removeClass(STCONST_CLASS_PLAYER_SMALLFONT),aq.addClass(STCONST_CLASS_PLAYER_MEDIUMFONT)):aq.hasClass(STCONST_CLASS_PLAYER_MEDIUMFONT)?(aq.removeClass(STCONST_CLASS_PLAYER_MEDIUMFONT),aq.addClass(STCONST_CLASS_PLAYER_SMALLFONT)):aq.hasClass(STCONST_CLASS_PLAYER_LARGEFONT)?(aq.removeClass(STCONST_CLASS_PLAYER_LARGEFONT),aq.addClass(STCONST_CLASS_PLAYER_SMALLFONT)):aq.addClass(STCONST_CLASS_PLAYER_MEDIUMFONT);aq.STredraw()});aj.dblclick(function(){aq.hasClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE)?b(this).trigger(STCONST_EVENT_PLAYER_HIDE):b(this).trigger(STCONST_EVENT_PLAYER_SHOW)});u.click(function(){b(this).trigger(STCONST_EVENT_PLAYER_SHOW)});var T=0,O=0,ah=aq.hasClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE),af=function(c){c=Math.max(O+c.pageY-T,0);al.height(c);c>0&&!ah?(ah=true,aq.addClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE),am.show(),ak.show()):c<=0&&ah&&(ah=false,aq.removeClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE),am.hide(),ak.hide());aq.STredraw("handleDrag");return false},ac=function(c){b("html").unbind("mouseup",ac);b("html").unbind("mouseleave",ac);b("html").unbind("mousemove",af);al.height()<a.minHeight&&c.pageY!=T&&al.animate({height:a.defaultHeight},200,function(){aq.STredraw()})};aj.mousedown(function(c){T=c.pageY;O=al.height();ah=aq.hasClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE);b("html").bind("mousemove",af);b("html").bind("mouseleave",ac);b("html").bind("mouseup",ac);return false});var R=0,P=0,ad=0,ab=0,aa=0,Y=0,W=an.get(0).style,U=function(c){c=Math.max(-P,Math.min((c.pageY-ab-aa)*Y,0));W.top=c+"px";aq.STredraw("scroll");return false},Z=function(){b(document).unbind("mouseup",Z);b(document).unbind("mouseleave",Z);b(document).unbind("mousemove",U)};V.mousedown(function(g){var m=am.css("padding-top"),m=parseInt(m.substring(0,m.length-2));ab=am.offset().top+m;aa=g.pageY-V.offset().top;R=am.height();P=an.height()-R;ad=V.height();Y=-1*P/(R-ad);aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF);b(document).bind("mousemove",U);b(document).bind("mouseleave",Z);b(document).bind("mouseup",Z);return false});am.mousewheel(function(n,o){var g=am.height(),g=an.height()-g;if(!(g<0)){var m=1;if(isChrome()||isFirefox()||isMSIE()){m=16}g=Math.max(-g,Math.min(an.position().top+m*o,0));W.top=g+"px";aq=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0);aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF);aq.STredraw("scroll")}},true);var S=function(c){aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF);var g=0,g=c=="line"?Math.min(an.position().top+18,0):Math.min(an.position().top+am.height()-20,0);an.css("top",g);aq.STredraw("scroll")},Q=function(g){var m=an.height()-am.height();if(!(m<0)){aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF);var n=0,n=g=="line"?Math.max(an.position().top-18,-m):Math.max(an.position().top-am.height()+20,-m);an.css("top",n);aq.STredraw("scroll")}};am.keydown(function(c){switch(c.keyCode){case 38:S("line");break;case 33:S("page");break;case 34:Q("page");break;case 40:Q("line")}(c.keyCode==38||c.keyCode==33||c.keyCode==40||c.keyCode==34)&&c.preventDefault()});J.click(function(){var c=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0);c.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL)==STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON?c.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF):c.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON);c.STredraw()});ai.keyup(function(c){b(this).trigger(STCONST_EVENT_PLAYER_SEARCH);(c.which&&c.which==13||c.keyCode&&c.keyCode==13)&&b(this).trigger(STCONST_EVENT_PLAYER_SEARCHNEXT);b(this).val()!=""?(ag.removeClass(STCONST_CLASS_PLAYER_SEARCHEMPTY),ae.removeClass(STCONST_CLASS_PLAYER_SEARCHEMPTY)):(ag.addClass(STCONST_CLASS_PLAYER_SEARCHEMPTY),ae.addClass(STCONST_CLASS_PLAYER_SEARCHEMPTY))});ai.focus(function(){b(this).hasClass(STCONST_CLASS_PLAYER_SEARCHEMPTY)&&(b(this).removeClass(STCONST_CLASS_PLAYER_SEARCHEMPTY),b(this).val(""),b(this).trigger(STCONST_EVENT_PLAYER_SEARCH))});ai.blur(function(){b(this).val()==""&&(b(this).val(STCONST_TEXT_BAR_SEARCH),b(this).addClass(STCONST_CLASS_PLAYER_SEARCHEMPTY),ag.addClass(STCONST_CLASS_PLAYER_SEARCHEMPTY),ae.addClass(STCONST_CLASS_PLAYER_SEARCHEMPTY))});ag.click(function(){b(this).trigger(STCONST_EVENT_PLAYER_SEARCHNEXT)});ae.click(function(){b(this).trigger(STCONST_EVENT_PLAYER_SEARCHPREV)});aq.bind(STCONST_EVENT_PLAYER_SHOW,function(){aq.addClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE);am.slideDown(500);ak.slideDown(500,function(){am.height("");aq.STredraw()})});aq.bind(STCONST_EVENT_PLAYER_HIDE,function(){am.slideUp(500,function(){aq.removeClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE)});ak.slideUp(500)});aq.bind(STCONST_EVENT_CONTENT_CLICKED,function(c,g){aq.onSTVPprogress(g.timestamp,true);aq.STVPseekToAndPlay(g.timestamp);aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON);aq.STredraw()});aq.bind(STCONST_EVENT_PLAYER_SEARCH,function(){var m=ai.val(),n=aq.STtranscript();aq.hasClass(STCONST_CLASS_PLAYER_TRANSCRIPT_VISIBLE)||b(this).trigger(STCONST_EVENT_PLAYER_SHOW);var g=m==""?[]:n.search(m);b(this).data(STCONST_DATAKEY_TRANSCRIPT_SEARCHMATCHES,g);b(this).STsearchPrevButton();b(this).STsearchNextButton();b(n.content).each(function(){var o=b("#"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+this.id),p=this.text;m!=""&&(p=p.replace(RegExp("("+m.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")+")","i"),"<span class='"+STCONST_CLASS_PLAYER_SEARCHMATCH+"'>$1</span>"));o.html(p)})});aq.bind(STCONST_EVENT_PLAYER_SEARCHNEXT,function(){var p=b(this).data(STCONST_DATAKEY_TRANSCRIPT_SEARCHMATCHES),q=b(this).data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID),n;b(this).STsearchField().val();if(p.length!=0){if(q>=p[p.length-1].id){n=p[0]}else{for(var o in p){var m=p[o];if(q<m.id){n=m;break}}}aq.trigger(STCONST_EVENT_CONTENT_CLICKED,[n])}});aq.bind(STCONST_EVENT_PLAYER_SEARCHPREV,function(){var g=b(this).data(STCONST_DATAKEY_TRANSCRIPT_SEARCHMATCHES),o=b(this).data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID),p;if(o<=g[0].id){p=g[g.length-1]}else{for(var m in g){var n=g[m];if(o<=n.id){break}p=n}}b(this).trigger(STCONST_EVENT_CONTENT_CLICKED,[p])});var X=function(){setTimeout(f,50)},f=function(){STgetSelectedText()==""&&(aq.trigger(STCONST_EVENT_CONTENT_DESELECT),b("html").unbind("mouseup",X),b("html").unbind("keyup",X))};aq.bind(STCONST_EVENT_CONTENT_SELECT,function(){a.editEnabled!=STCONST_CONFIG_EDITENABLED_ON&&(b(this).STsharePane().addClass(STCONST_CLASS_PLAYER_SHAREPANE_HIGHLIGHT).find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_HIGHLIGHTED),b("html").bind("mouseup",X),b("html").bind("keyup",X))});aq.bind(STCONST_EVENT_CONTENT_DESELECT,function(){b(this).STsharePane().removeClass(STCONST_CLASS_PLAYER_SHAREPANE_HIGHLIGHT).find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_SELECTED);b(this).STsharePane().hasClass(STCONST_CLASS_PLAYER_SHAREPANE_ACTIVE)||(b(this).STsharePane().removeClass(STCONST_CLASS_COPY_FEEDBACK).find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_UNSELECTED),b(this).STsharePane().find("."+STCONST_CLASS_SHARE_BUTTON).show())});aq.bind(STCONST_EVENT_CONTENT_COPY,function(){a.editEnabled!=STCONST_CONFIG_EDITENABLED_ON&&(aq.STshowCopyMessage(),window.setTimeout(function(){aq.SThideCopyMessage()},5000))});aq.bind(STCONST_EVENT_TRANSCRIPT_LOADED,function(c,g){b("."+STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING+g).each(function(){b(this).removeClass(STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING+g);b(this).STrenderTranscript(g)})});aq.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL,STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON);aq.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID,0);aq.data(STCONST_DATAKEY_CONFIG,a);aq.data(STCONST_DATAKEY_TRANSCRIPT_IGNOREPROGRESS,false);a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&aq.data(STCONST_DATAKEY_EDITMESSAGE_SHOWN,false);aq.hasClass(STCONST_CLASS_EMBEDDED)&&(aq.STtranscriptWrapper().height(a.defaultHeight),aq.STsharePane().height(a.defaultHeight+14));a.initialState==STCONST_CONFIG_INITIALSTATE_OPEN?aq.trigger(STCONST_EVENT_PLAYER_SHOW):aq.trigger(STCONST_EVENT_PLAYER_HIDE);aq.STloadTranscriptFromPage();aj=Math.max(400,aq.width());a.matchVideoWidth&&(aj=Math.max(400,b(this).width()));aq.width(aj-(aq.outerWidth()-aq.innerWidth()));ao.width(aj-(ao.outerWidth()-ao.innerWidth()));ap.width(aj-(ap.outerWidth()-ap.innerWidth()));b(this).css("text-align")=="center"?aq.css("margin","0 auto"):aq.css("margin-left",b(this).css("margin-left"));aq.width()<460&&aq.addClass("narrow");aq.STredraw()});return this},STcaptureQuoteLink:function(){var a=STgetSelectedText()+"",e=STgetSelectedContentID();a==""&&(a=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0),e=a.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID),a=a.STtranscriptDisplay().find("#"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+e).text());b(this).data(STCONST_DATAKEY_QUOTELINK_TEXT,a);b(this).data(STCONST_DATAKEY_QUOTELINK_CONTENTID,e)},STtwitterShare:function(m){var n=b(this).data(STCONST_DATAKEY_QUOTELINK_TEXT),a=b(this).data(STCONST_DATAKEY_QUOTELINK_CONTENTID),h=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0),h=b(h).STtranscript(),a=h.getContentByID(a),f=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+h.transcriptID,a.timestamp);b.ajax({type:"GET",url:"http://api.bit.ly/v3/shorten",dataType:"jsonp",data:{login:STCONSTS_WSCREDS_BITLY_LOGIN,apiKey:STCONSTS_WSCREDS_BITLY_APIKEY,longUrl:f,format:"json"},success:function(g,c){new j;f=" - "+g.data.url;c=n.replace("\n","");c.length+f.length>140&&(c=c.slice(0,138-f.length));var c='"'+c+'"'+f,o="http://twitter.com/intent/tweet?text="+encodeURIComponent(c);m.document.location=o},error:function(){}})},STfacebookShare:function(m){var n=b(this).data(STCONST_DATAKEY_QUOTELINK_TEXT),a=b(this).data(STCONST_DATAKEY_QUOTELINK_CONTENTID),h=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0),h=b(h).STtranscript(),a=h.getContentByID(a),f=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+h.transcriptID,a.timestamp);b.ajax({type:"GET",url:"http://api.bit.ly/v3/shorten",dataType:"jsonp",data:{login:STCONSTS_WSCREDS_BITLY_LOGIN,apiKey:STCONSTS_WSCREDS_BITLY_APIKEY,longUrl:f,format:"json"},success:function(c){new j;f=c.data.url;c="http://facebook.com/sharer.php?u="+encodeURIComponent(f)+"&t="+encodeURIComponent(n);m.document.location=c},error:function(){}})},STurlShare:function(){b(this).data(STCONST_DATAKEY_QUOTELINK_TEXT);var g=b(this).data(STCONST_DATAKEY_QUOTELINK_CONTENTID),h=b(this).parents("."+STCONST_CLASS_PLAYER).eq(0),a=b(h).STtranscript(),g=a.getContentByID(g),f=STsetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+a.transcriptID,g.timestamp);b.ajax({type:"GET",url:"http://api.bit.ly/v3/shorten",dataType:"jsonp",data:{login:STCONSTS_WSCREDS_BITLY_LOGIN,apiKey:STCONSTS_WSCREDS_BITLY_APIKEY,longUrl:f,format:"json"},success:function(c){new j;f=c.data.url;h.STshowMessage(STCONST_TEXT_MESSAGE_SHAREURL_BEGIN+f+STCONST_TEXT_MESSAGE_SHAREURL_END);timeout=h.data(STCONST_DATAKEY_SHAREURL_TIMEOUT);window.clearTimeout(timeout);h.data(STCONST_DATAKEY_SHAREURL_TIMEOUT,window.setTimeout(function(){b(h).SThideMessage()},10000))},error:function(){}})},STredraw:function(u){var s=this.STtranscriptPane(),t=this.STtranscriptDisplay(),q=this.STsharePane(),r=this.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID),p=t.position().top,o=p,n=t.height(),s=s.height(),m=this.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL);if(u!="scroll"){s<=0?q.height(0):q.height(s+14);if(r!=0&&m==STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON&&(r=t.find("#"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+r),q=Math.min(r.position().top,n-s),r=r.height(),r=q+r+p,r<-1||r>s)){o=-q}n=-(n-s);p<n&&(o=Math.min(0,n));STplayer=this;o!=p&&(u=="handleDrag"?t.css("top",o):t.animate({top:o},{step:function(){STplayer.STredrawScrollBar()}}))}u=this.find("."+STCONST_CLASS_PLAYER_AUTOSCROLL);m=this.data(STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL);u.removeClass(STCONST_CLASS_PLAYER_AUTOSCROLL_ON+" "+STCONST_CLASS_PLAYER_AUTOSCROLL_OFF);switch(m){case STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_OFF:u.addClass(STCONST_CLASS_PLAYER_AUTOSCROLL_OFF);break;case STCONST_FLAG_TRANSCRIPT_AUTOSCROLL_ON:u.addClass(STCONST_CLASS_PLAYER_AUTOSCROLL_ON)}this.STredrawScrollBar()},STredrawScrollBar:function(){var h=this.STscrollVisible(),o=this.STtranscriptPane(),g=this.STtranscriptDisplay(),m=g.height(),o=o.height(),g=g.position().top;if(m>0&&o<m){var n=Math.max(o/m*o,0)+10;o<n?h.hide():h.is(":hidden")&&h.show();h.height(n).css("top",-1*g/(m-o)*(o-n))}else{h.hide()}},STrenderTranscript:function(r){if(!(r in l)){return this}if(b(this).data(STCONST_DATAKEY_TRANSCRIPTID)!=r){var p=l[r];b(this).STtranscriptStatus().html("");var a=b(this).data(STCONST_DATAKEY_CONFIG);b(this).data(STCONST_DATAKEY_TRANSCRIPTID,r);var q="";a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&(q=" contenteditable='true'");b(this).STtranscriptPane();var o=b(this).STtranscriptDisplay();if(b(this).hasClass(STCONST_CLASS_EMBEDDED)){b(this).removeClass(STCONST_CLASS_EMBEDDED)}else{var n=[];b(p.content).each(function(){n.push("<span id='"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+this.id+"' class='"+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT+"'"+q+">"+this.text+"</span>")});var m=n.join("");o.html(m)}b(this).removeClass(STCONST_CLASS_UNINITIALIZED);var c=this;b(o).find("."+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT).click(function(){if(a.editEnabled==STCONST_CONFIG_EDITENABLED_ON){if(b(this).hasClass(STCONST_CLASS_PLAYER_CURRENTCONTENT)){return}c.data(STCONST_DATAKEY_EDITMESSAGE_SHOWN)||(c.data(STCONST_DATAKEY_EDITMESSAGE_SHOWN,true),c.STshowMessage(STCONST_TEXT_MESSAGE_EDIT),window.setTimeout(function(){b(c).SThideMessage()},5000))}if(STgetSelectedText()==""){var e=b(this).STtranscript(),f=b(this).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length);(e=e.getContentByID(f))&&b(this).trigger(STCONST_EVENT_CONTENT_CLICKED,[e])}});a.editEnabled==STCONST_CONFIG_EDITENABLED_ON&&b(o).find("."+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT).blur(function(){var e=b(this).STtranscript(),f=b(this).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length);b(this).removeClass(STCONST_CLASS_EDIT_EMPTY);b(this).html()==""&&(b(this).html(" "),b(this).addClass(STCONST_CLASS_EDIT_EMPTY));e.updateContentByID(f,b(this).html())}).bind("keydown",function(e){if(e.keyCode==8&&(e=b(this).prev().get(0),typeof e!=="undefined"&&e.lastChild.nodeType===Node.ELEMENT_NODE&&e.lastChild.nodeName.toLowerCase()==="br")){var f=window.getSelection();f.anchorOffset==0&&(f.anchorNode==this||f.anchorNode==this.firstChild)&&e.removeChild(e.lastChild)}}).bind("keypress",function(f){if(isFirefox()&&f.keyCode==13){f=window.getSelection().getRangeAt(0);f.deleteContents();var e=document.createElement("br");f.insertNode(e);f.setStartAfter(e)}});timestamp=STgetURLParameterByName(window.location.href,STCONST_QUERY_PLAYER_QUOTELINK+r);timestamp!=""&&(timestamp=new Number(timestamp),r=p.getContentByTimestamp(timestamp),b(this).trigger(STCONST_EVENT_PLAYER_SHOW),b(this).trigger(STCONST_EVENT_CONTENT_CLICKED,[r]));b(this).STredraw();return this}},STvideoPlayer:function(){return b("#"+b(this).data(STCONST_DATAKEY_VIDEOPLAYERID))},STbar:function(){return b(this).find("."+STCONST_CLASS_PLAYER_BAR)},STtranscriptPane:function(){return b(this).find("."+STCONST_CLASS_PLAYER_TRANSCRIPTPANE)},STsharePane:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SHAREPANE)},STtranscriptDisplay:function(){return b(this).find("."+STCONST_CLASS_PLAYER_TRANSCRIPTDISPLAY)},STtranscriptWrapper:function(){return b(this).find("."+STCONST_CLASS_PLAYER_TRANSCRIPTWRAPPER)},STtranscriptStatus:function(){return b(this).find("."+STCONST_CLASS_PLAYER_TRANSCRIPTSTATUS)},STplayerHandle:function(){return b(this).find("."+STCONST_CLASS_PLAYER_HANDLE)},STplayerBase:function(){return b(this).find("."+STCONST_CLASS_PLAYER_BASE)},STautoScrollButton:function(){return b(this).find("."+STCONST_CLASS_PLAYER_AUTOSCROLL)},STtranscriptShowButton:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SHOWTEXT)},STscrollBar:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SCROLLBAR)},STscrollUp:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SCROLLUP)},STscrollDown:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SCROLLDOWN)},STscrollVisible:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SCROLLVISIBLE)},STsearch:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SEARCH)},STsearchField:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SEARCHFIELD)},STembedWrapper:function(){return b(this).find("."+STCONST_CLASS_PLAYER_EMBEDWRAPPER)},STsearchPrevButton:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SEARCHPREVBUTTON)},STsearchNextButton:function(){return b(this).find("."+STCONST_CLASS_PLAYER_SEARCHNEXTBUTTON)},STfontSizeButton:function(){return b(this).find("."+STCONST_CLASS_PLAYER_FONTSIZEBUTTON)},STmessagePane:function(){return b(this).find("."+STCONST_CLASS_MESSAGEPANE)},STtranscript:function(){var a;a=b(this).hasClass(STCONST_CLASS_PLAYER)?b(this).data(STCONST_DATAKEY_TRANSCRIPTID):b(this).parents("."+STCONST_CLASS_PLAYER).eq(0).data(STCONST_DATAKEY_TRANSCRIPTID);return l[a]?l[a]:null},STsaveButton:function(){return b(this).find("."+STCONST_CLASS_EDIT_SAVE)},STcancelButton:function(){return b(this).find("."+STCONST_CLASS_EDIT_CANCEL)},STplayer:function(){var a=b(this).attr("id");return a in k?k[a]:null},STautoScroll:function(){return b(this).find("."+STCONST_DATAKEY_TRANSCRIPT_AUTOSCROLL)},STloadTranscriptFromPage:function(){var c=this.attr("id").replace(STCONST_PLAYER_TRANSCRIPTEMBED_PREFIX+"_","");b(this).addClass(STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING+c);b(this).STtranscriptStatus().html(STCONST_TEXT_TRANSCRIPT_LOADING);var a=new j;b(this).find("."+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT).each(function(){var e=new i;e.id=parseInt(b(this).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length));e.timestamp=parseInt(b(this).attr("name"));e.text=b(this).html();a.content.push(e)});a.transcriptID=c;a.hash=b(this).attr("data-hash");l[c]=a;b(this).trigger(STCONST_EVENT_TRANSCRIPT_LOADED,[c]);return this},STloadTranscriptFromServer:function(g){b(this).STtranscriptDisplay().html("");var f=g.replace(/-/g,"_");if(f in l&&l[f] instanceof j){return b(this).STrenderTranscript(f),this}else{if(f in l&&l[f] instanceof XMLHttpRequest){return b(this).addClass(STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING+f),this}}b(this).addClass(STCONST_CLASS_PLAYER_TRANSCRIPT_LOADING+f);var a=b(this).STtranscriptStatus();a.html(STCONST_TEXT_TRANSCRIPT_LOADING);var c=b(this).data(STCONST_DATAKEY_CONFIG).transcriptPath;c.length>0&&c.charAt(c.length-1)!="/"&&(c+="/");c+=g+".html";STplayer=b(this);l[f]=b.ajax({type:"GET",cache:false,url:c,dataType:"html",success:function(m){a.html("");var e=new j;b(m).find("."+STCONST_CLASS_PLAYER_TRANSCRIPT_CONTENT).each(function(){var h=new i;h.id=parseInt(b(this).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length));h.timestamp=parseInt(b(this).attr("name"));h.text=b(this).html();e.content.push(h)});e.transcriptID=f;e.hash=b(m).attr("data-hash");l[f]=e;STplayer.trigger(STCONST_EVENT_TRANSCRIPT_LOADED,[f])},error:function(){a.html(STCONST_TEXT_TRANSCRIPT_UNAVAILABLE)}});return this},STshowMessage:function(a){var e=b(this).STmessagePane();e.html(a);e.fadeIn(200)},STshowCopyMessage:function(){var a=b(this).STsharePane();a.addClass(STCONST_CLASS_COPY_FEEDBACK);a.find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_MESSAGE_COPY);a.find("."+STCONST_CLASS_SHARE_BUTTON).hide()},SThideMessage:function(){b(this).STmessagePane().fadeOut(200)},SThideCopyMessage:function(){var a=b(this).STsharePane().removeClass(STCONST_CLASS_COPY_FEEDBACK);a.hasClass(STCONST_CLASS_PLAYER_SHAREPANE_HIGHLIGHT)?a.find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_HIGHLIGHTED):a.hasClass(STCONST_CLASS_PLAYER_SHAREPANE_HIGHLIGHT)?a.find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_SELECTED):a.find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_UNSELECTED);a.find("."+STCONST_CLASS_SHARE_BUTTON).show()},onSTVPprogress:function(m,q){if(!(typeof m=="undefined"||isNaN(m)||m<=0)){var h=this.STplayer()==null?this:this.STplayer();if(h!=null){var p=h.data(STCONST_DATAKEY_PLAYERQUEUE);typeof p=="undefined"?h.data(STCONST_DATAKEY_PLAYERQUEUE,-1):p!=-1&&(h.data(STCONST_DATAKEY_PLAYERQUEUE,-1),h.STVPseekTo(p));var o=h.STtranscript();if(o!=null){var p=o.getContentByTimestamp(m),n=h.data(STCONST_DATAKEY_TRANSCRIPT_IGNOREPROGRESS);if(n!==false&&!q){if(p.id<n||p.timestamp-STCONST_PLAYER_IGNORE_THRESHOLD>o.getContentByID(n).timestamp){return}else{h.data(STCONST_DATAKEY_TRANSCRIPT_IGNOREPROGRESS,false)}}o=h.STtranscriptDisplay();n=h.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID);n!=p.id&&(o.find("#"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+n).removeClass(STCONST_CLASS_PLAYER_CURRENTCONTENT),h.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID,p.id),o.find("#"+STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX+p.id).addClass(STCONST_CLASS_PLAYER_CURRENTCONTENT),q&&h.data(STCONST_DATAKEY_TRANSCRIPT_IGNOREPROGRESS,p.id),h.STsharePane().hasClass(STCONST_CLASS_PLAYER_SHAREPANE_ACTIVE)||h.STsharePane().addClass(STCONST_CLASS_PLAYER_SHAREPANE_ACTIVE).find("."+STCONST_CLASS_PLAYER_SHAREPANE_TEXT).html(STCONST_TEXT_SHARE_SELECTED),h.STredraw())}}}},STVPseekTo:function(a){typeof a!="undefined"&&b(this).data(STCONST_DATAKEY_VIDEOPLAYER).seekTo(a)},STVPseekToAndPlay:function(e){var f=this.data(STCONST_DATAKEY_VIDEOPLAYER);f.isPlaying()&&!this.data(STCONST_DATAKEY_PLAYER_DISABLED)?this.STVPseekTo(e):(f.play(),this.data(STCONST_DATAKEY_PLAYERQUEUE,e))}})})(stjQuery);function isChrome(){return navigator.userAgent.toLowerCase().indexOf("chrome")!=-1}function isFirefox(){return navigator.userAgent.toLowerCase().indexOf("firefox")!=-1}function isMSIE(){return navigator.userAgent.toLowerCase().indexOf("msie")!=-1}function STgetSelectedText(){if(window.getSelection){return window.getSelection()}else{if(document.getSelection){return document.getSelection()}else{if(document.selection){return document.selection.createRange().text}}}return""}function STgetSelectedContentID(){if(typeof window.getSelection!="undefined"){var b=window.getSelection();if(b.toString()){return typeof b.setBaseAndExtent=="undefined"&&(b=window.getSelection()),b=b.getRangeAt(0),b=b.cloneRange(),b.collapse(true),b=b.startContainer,typeof stjQuery(b).attr("id")=="undefined"&&(b=stjQuery(b).parent()),stjQuery(b).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length)}}else{if(document.selection){return document.selection.createRange(),b=document.selection.createRange(),b.collapse(true),b=b.parentElement(),stjQuery(b).attr("id").slice(STCONST_PLAYER_TRANSCRIPTCONTENT_PREFIX.length)}}}function STgetURLParameterByName(b,c){var c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),d=RegExp("[\\?&]?"+c+"=([^&#]*)").exec(b);return d==null?"":decodeURIComponent(d[1].replace(/\+/g," "))}function STsetURLParameterByName(b,d,h){var j="";if(b.indexOf("?")!=-1){var i=b.indexOf(d+"=");i!=-1?(j=b.substring(0,i)+d+"="+h,isThereMore=b.indexOf("&",i),isThereMore>-1&&(j+=b.substring(isThereMore))):j=b+"&"+d+"="+h}else{j=b+"?"+d+"="+h}return j}stjQuery.fn.extend({mousewheel:function(b,c,d){return this.hover(function(){stjQuery.event.mousewheel.giveFocus(this,b,c,d)},function(){stjQuery.event.mousewheel.removeFocus(this)})},mousewheeldown:function(b,c){return this.mousewheel(function(){},b,c)},mousewheelup:function(b,c){return this.mousewheel(b,function(){},c)},unmousewheel:function(){return this.each(function(){stjQuery(this).unmouseover().unmouseout();stjQuery.event.mousewheel.removeFocus(this)})},unmousewheeldown:stjQuery.fn.unmousewheel,unmousewheelup:stjQuery.fn.unmousewheel});stjQuery.event.mousewheel={giveFocus:function(b,d,e,h){b._handleMousewheel&&stjQuery(b).unmousewheel();h==window.undefined&&e&&e.constructor!=Function&&(h=e,e=null);b._handleMousewheel=function(c){if(!c){c=window.event}if(h){c.preventDefault?c.preventDefault():c.returnValue=false}var a=0;c.wheelDelta?(a=c.wheelDelta/120,window.opera&&(a=-a)):c.detail&&(a=-c.detail/3);d&&(a>0||!e)?d.apply(b,[c,a]):e&&a<0&&e.apply(b,[c,a])};window.addEventListener&&window.addEventListener("DOMMouseScroll",b._handleMousewheel,false);window.onmousewheel=document.onmousewheel=b._handleMousewheel},removeFocus:function(b){if(b._handleMousewheel){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",b._handleMousewheel,false),window.onmousewheel=document.onmousewheel=null,b._handleMousewheel=null}}};stjQuery.extend({loadCaptionBoxDependency:function(b,c){var d=stjQuery("script[src*='"+STCONST_FILENAME+"']").attr("src").replace(RegExp("(.*)"+STCONST_FILENAME+".*"),"$1");stjQuery.ajax({type:"GET",url:d+b,success:c,dataType:"script",cache:true})}});var STVP_PLAYER_AUTOID_PREFIX="STautoID";(function(b){var c=0;b.fixVideoEmbeds=function(a,g){function d(){b("object, embed:not(object > embed)").each(function(){if(!b(this).html().match(a)){return true}c++;var l=b(this),m=l.attr("height"),i=l.attr("width"),f=l.attr("id");if(typeof f=="undefined"||f==""){f=STVP_PLAYER_AUTOID_PREFIX+c}l.attr("id",f).attr("name",f);var h="";if(l.is("embed")){h=l.attr("src")}else{if(h=l.find("embed"),h.length){h=h.attr("src")}else{if(l.attr("data")){h=l.attr("data")}else{return true}}}var j={};l.get(0).tagName.toLowerCase()=="object"&&l.find("param").each(function(){j[b(this).attr("name")]=b(this).attr("value")});j.allowScriptAccess="always";typeof g=="function"&&(h=g(h,f));swfobject.embedSWF(h,f,i,m,"8",null,null,j,{id:f,name:f})})}typeof swfobject=="undefined"?b.getScript(window.document.location.protocol+"//ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",d):d()}})(stjQuery);(function(b){function c(d,e){this.player=d;this.videoId=e}c.prototype={cbHostId:4,seekTo:function(d){this.player.sendEvent("seek",d/1000)},play:function(){this.player.sendEvent("play")},isPlaying:function(){return false}};window.getUpdate=function(g,k){var i=b("embed[src*='blip.tv']").first(),a="";i.length>0?(i=i.first(),a=i.attr("src")):(i=b("object[data*='blip.tv']").first(),a=i.attr("data"));a=a.match(/play\/([a-zA-Z0-9+]+)/)[1];if(a.indexOf("+")!==-1){var j=STCONST_PLAYER_TRANSCRIPTEMBED_PREFIX+"_4_"+a;b("#"+j.replace(/\+/g,"\\+")).attr("id",j.replace(/\+/g,"plus"))}i.hasCaptionBox()||i.captionBox({videoPlayer:new c(i.get(0),a.replace(/\+/g,"plus"))});switch(g){case"time":case"current_time_change":i.onSTVPprogress(k*1000)}};b(function(){b.fixVideoEmbeds("blip.tv")})})(stjQuery);(function(b){function c(d){this.player=d;this.modVP=brightcove.getExperience(this.player.attr("id")).getModule(APIModules.VIDEO_PLAYER);this.videoId=this.modVP.getCurrentVideo().id}c.prototype={cbHostId:3,seekTo:function(d){this.modVP.seek(d/1000)},play:function(){this.modVP.pause(false)},isPlaying:function(){return this.modVP.isPlaying()}};window.onTemplateLoaded=function(d){var i=brightcove.getExperience(d),g=i.getModule(APIModules.VIDEO_PLAYER);i.getModule(APIModules.EXPERIENCE);i.getModule(APIModules.CONTENT);var a=b("#"+d),d=function(){var f=g.getCurrentVideo().id,h=new c(a);if(a.STplayer()===null){a.captionBox({videoPlayer:h}),g.pause(true)}else{var e=a.STplayer();e.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID,0);e.STloadTranscriptFromServer(h.cbHostId+"-"+f)}};g.getCurrentVideo()!=null?d():g.addEventListener(BCMediaEvent.CHANGE,d);g.addEventListener(BCMediaEvent.PROGRESS,function(e){a.onSTVPprogress(e.position*1000)})};b(function(){if(typeof brightcove!="undefined"&&typeof APIModules=="undefined"){var a=brightcove.cdnURL;if(window.location.protocol=="https:"){a=brightcove.secureCDNURL}b.ajax({async:false,type:"GET",url:a+"/js/APIModules_all.js",dataType:"script"})}})})(stjQuery);(function(b){function c(d,e){this.player=d;this.videoId=e}c.prototype={cbHostId:7,seekTo:function(d){this.player.sendEvent("SEEK",d/1000)},play:function(){this.player.sendEvent("PLAY")},isPlaying:function(){return this.player.getConfig().state!=="IDLE"}};window.playerReady=function(d){typeof d.id!="undefined"&&(d=document.getElementById(d.id),d.addModelListener("TIME","st_jw_onProgress"),d.addControllerListener("ITEM","st_jw_itemChanged"))};window.st_jw_itemChanged=function(d){if(typeof d.id!="undefined"){var i=document.getElementById(d.id),g=b(i).STplayer(),a=i.getPlaylist()[d.index];g==null?(d=b(i).attr("data-stid"),typeof d!=="undefined"&&d!==false?b(i).captionBox({videoPlayer:new c(i,""),preEmbedID:d}):typeof a.captionbox!=="undefined"?b(i).captionBox({videoPlayer:new c(i,a.captionbox)}):(d=function(){var e=a.file,e=b("<a/>").attr("href",e)[0],e=e.pathname.replace(/^[^\/]/,"/")+e.search,e=sha1Hash(e);b(i).captionBox({videoPlayer:new c(i,e)})},typeof sha1Hash=="undefined"?b.loadCaptionBoxDependency("sha1.js",d):d())):(g.data(STCONST_DATAKEY_TRANSCRIPT_CURRENTCONTENTID,0),g.STloadTranscriptFromServer(a.captionbox))}};window.st_jw_onProgress=function(a){if(typeof a.id!="undefined"){b("#"+a.id).onSTVPprogress(parseFloat(a.position)*1000)}}})(stjQuery);(function(b){function c(d){this.player=d;this.videoId=this.player.getCurrentItem().embedCode}c.prototype={cbHostId:5,seekTo:function(d){this.player.setPlayheadTime(d/1000)},play:function(){this.player.playMovie()},isPlaying:function(){return this.player.getState()!="playing"}};window.st_ooyala_callback=function(g,k,i){var g=b("#"+g),a=g.parent(),j=a.STplayer();switch(k){case"apiReady":a.captionBox({videoPlayer:new c(g.get(0))});a.STplayer().data(STCONST_DATAKEY_PLAYER_DISABLED,false);break;case"playheadTimeChanged":if(!j.data(STCONST_DATAKEY_PLAYER_DISABLED)){a.onSTVPprogress(i.playheadTime*1000)}break;case"adStarted":j.data(STCONST_DATAKEY_PLAYER_DISABLED,true);break;case"adCompleted":j.data(STCONST_DATAKEY_PLAYER_DISABLED,false)}}})(stjQuery);(function(b){function c(f,g){this.player=f;this.videoId=g}function d(h,g){var a=b(h).is("object")?b(h):b(h).parent();a.captionBox({videoPlayer:new c(h,g.mediaId)});window.setInterval(function(){a.onSTVPprogress(h.api_getTrackPosition()*1000)},100)}c.prototype={cbHostId:6,seekTo:function(e){this.player.api_seekTo(e/1000)},play:function(){this.player.api_play()},isPlaying:function(){return false}};b(function(){b.fixVideoEmbeds("soundcloud.com",function(f,g){STgetURLParameterByName(f,"enable_api")!=="true"&&(f=STsetURLParameterByName(f,"enable_api","true"));STgetURLParameterByName(f,"object_id")!==g&&(f=STsetURLParameterByName(f,"object_id",g));return f});b("object[data*='soundcloud.com'], embed[src*='soundcloud.com']").length>0&&b.loadCaptionBoxDependency("soundcloud.player.api.js",function(){soundcloud.addEventListener("onPlayerReady",d)})})})(stjQuery);(function(b){function c(a){this.player=a;this.videoId=b(a).children("param[name='flashvars']").attr("value").replace(/.*vid=(\d+).*/,"$1");this.player.ready()}function d(f){var a=b("#"+f);a.captionBox({videoPlayer:new c(a.get(0))});setInterval(function(){var e=a.get(0).getProperty("logic.media","time");a.onSTVPprogress(e*1000)},100)}c.prototype={cbHostId:9,seekTo:function(f){f/=1000;var g=this.player.getProperty("logic.media","duration");this.player.callMethod("logic.media","seek",f/g,false,true)},play:function(){this.player.callMethod("logic.media","play")},isPlaying:function(){return this.player.getProperty("logic.media","playing")}};if(typeof ustream=="undefined"){window.ustream={}}if(typeof ustream.flash=="undefined"){window.ustream.flash={}}if(typeof ustream.flash.viewer=="undefined"){window.ustream.flash.viewer={}}b(function(){b.fixVideoEmbeds("ustream.tv");b("object[id*='ustream']").each(function(){var a=b(this).attr("id");typeof window.ustream.flash.viewer[a]=="undefined"&&(window.ustream.flash.viewer[a]={ready:function(){d(a)}})})})})(stjQuery);(function(b){function c(a){this.player=a;this.videoId=b(a.element).attr("src").match(/video\/(\d+)/)[1]}function d(f){var a=b("#"+f),f=Froogaloop(f);a.captionBox({videoPlayer:new c(f)});f.addEvent("playProgress",function(e){a.onSTVPprogress(parseFloat(e.seconds)*1000)})}c.prototype={cbHostId:2,seekTo:function(e){this.player.api("seekTo",e/1000)},play:function(){this.player.api("play")},isPlaying:function(){this.player.api("paused",function(){});return false}};b(function(){function f(){var e=0;a.each(function(){var i=b(this).attr("src"),h=STgetURLParameterByName(i,"api"),g=STgetURLParameterByName(i,"player_id");h==="1"&&typeof g!=="undefined"&&g!==""?g!==b(this).attr("id")&&b(this).attr("id",g):(i=STsetURLParameterByName(i,"api","1"),g=g||STVP_PLAYER_AUTOID_PREFIX+"_vimeo_"+e++,i=STsetURLParameterByName(i,"player_id",g),b(this).attr("src",i),b(this).attr("id",g));Froogaloop(g).addEvent("ready",d)})}var a=b("iframe[src*='vimeo']");a.length>0&&(typeof Froogaloop=="undefined"?b.loadCaptionBoxDependency("froogaloop.min.js",f):f())})})(stjQuery);(function(b){function c(a){this.player=a;this.videoId=b(this.player).attr("id").replace(/wistia_(\d+).*/,"$1")}function d(f){var a=b("#"+f);a.captionBox({videoPlayer:new c(a.get(0))});window.setInterval(function(){var e=a.get(0).getCurrentTime();a.onSTVPprogress(e*1000)},100)}c.prototype={cbHostId:8,seekTo:function(e){this.player.videoSeek(e/1000)},play:function(){this.player.videoPlay()},isPlaying:function(){this.player.getCurrentState()}};b(function(){b.fixVideoEmbeds("wistia.com");var a=setInterval(function(){b("object[id*='wistia']").each(function(){var h=b(this).attr("id");try{return b(this).get(0).getCurrentState(),a=clearInterval(a),d(h),false}catch(f){}})},100)})})(stjQuery);(function(b){function c(d){this.player=d;this.videoId=this.player.getVideoUrl().match(/v=([a-zA-Z0-9_\-]+)/)[1]}c.prototype={cbHostId:1,seekTo:function(d){this.player.seekTo(d/1000,true)},play:function(){this.player.playVideo()},isPlaying:function(){return this.player.getPlayerState()==1}};window.onYouTubePlayerReady=function(a){if(typeof a!="undefined"){var g=b("#"+a),d=g.is("object")?g:g.parent();d.captionBox({videoPlayer:new c(g.get(0))});window.setInterval(function(){d.onSTVPprogress(g.get(0).getCurrentTime()*1000)},100)}};window.onYouTubePlayerAPIReady=function(){b("iframe[src*='youtube']").each(function(){new YT.Player(b(this).attr("id"),{events:{onReady:function(a){var g=a.target,d=b(g.a);d.captionBox({videoPlayer:new c(g)});window.setInterval(function(){d.onSTVPprogress(g.getCurrentTime()*1000)},100)}}})})};b(function(){b.fixVideoEmbeds("youtube.com",function(e,f){STgetURLParameterByName(e,"enablejsapi")!=1&&(e=STsetURLParameterByName(e,"enablejsapi",1));STgetURLParameterByName(e,"playerapiid")!=f&&(e=STsetURLParameterByName(e,"playerapiid",f));return e});var a=0,d=b("iframe[src*='youtube']");d.length>0&&(d.each(function(){var e=b(this).attr("id");if(typeof e=="undefined"||e==""){e=STVP_PLAYER_AUTOID_PREFIX+"_youtube_"+a++,b(this).attr("id",e)}e=b(this).attr("src");STgetURLParameterByName(e,"enablejsapi")!=="1"&&(e=STsetURLParameterByName(e,"enablejsapi","1"),b(this).attr("src",e))}),typeof YT=="undefined"&&b.getScript(window.document.location.protocol+"//www.youtube.com/player_api"))})})(stjQuery);
jQuery(function(d){var b=[];var e=4;var g='<li class="empty"><span class="removed">Empty</span></li>';var m=["product-finder","from-product-finder","compare"];var n=d("#filter-tabs ul");var l=d("#filter-panel-group");var f=d("#filter-panel-group > div");var s=n.find("li.on").attr("id");d("#shortlist ul").children("li:not(.empty)").each(function(){b.push(d(this).attr("class"))});d("#productFinder").click(function(u){var t=d(u.target);if(t.parent().is("a.add")){return p(t.parent())}else{if(t.parent().is("a.remove")||t.is("a.remove")){return r(t.parent())}else{if(t.parents("#filter-tabs").length==1){return c(t)}else{if(t.is("input.button")){return j(t)}}}}if(t.parents("#start-again").length==0){if(t.is("a")){return q(t)}else{if(t.parent().is("a")){return q(t.parent())}}}return true});function p(u){if(b.length==0){var t=true}else{var t=false}b.push(u.parent().attr("id"));u.removeClass("add").addClass("remove");a(u.parent(),"added",t);h(u,"remove-cross2.png","Remove this product from the comparison basket");o();return false}function r(t){var v=t.parent().attr("id")||t.parent().attr("class");var u=jQuery.inArray(v,b);var w=d("#"+v+" a");a(w.parent(),"removed");w.removeClass("remove").addClass("add");h(w,"add-plus2.png","Add this product to the comparison basket");b.splice(u,1);d("."+v).fadeOut(1000,function(){o()});return false}function q(t){var u=-1;var v=t.attr("href").split("/");for(i in m){if(u==-1){u=jQuery.inArray(m[i],v)}}window.location.href=k(v,u);return false}function j(t){var u=s.split("-");u=u[u.length-1];d("#basketItems").val(b.join(","));d("#activeForm").val(u);d(t.parents("form").get(0)).submit();return false}function c(t){var x=t.parent().parent();if(x.hasClass("off")){var u=n.children("li").index(x[0]);var y=x.text();s=x.attr("id");$on=n.find("li.on:first");var z=$on.html();var w=$on.text();var v=n.children("li").index($on[0]);x.children().clone().prependTo($on.empty()).find("span").text(w);x.empty().html(z).find("span").text(y);n.children("li").removeClass("on").addClass("off");x.removeClass("off").addClass("on");l.css("height",f.eq(v).css("height"));f.hide();f.eq(u).show();l.css("height","auto")}return false}function k(v,t){var u="basket-";if(v[t].match(/compare/)){t++}if(v[t+1].match(/page-[0-9]/)){v.splice(t+1,0,u+b.join(","))}else{v[t+1]=u+b.join(",")}var w=0;jQuery.each(v,function(x,y){if(y.match(/activefilter-/)){w=x}});if(w!=0){v[w]=s}return v.join("/")}function h(u,w,t){if(u.children("img").length){var v=u.children("img").attr("src").split("/");v[v.length-1]=w;u.children("img").attr("src",v.join("/"));u.children("img").attr("alt",t);u.children("img").attr("title",t)}}function a(w,v,u){var x=d('<div id="feedback" class="'+v+'fb">Item '+v+" above</div>");w.append(x);if(u){var t=5000}else{var t=1500}x.fadeOut(t,function(){x.remove()})}function o(){var u=[];jQuery.each(b,function(C,E){if(d("#shortlist ."+E).length){u.push(d("#shortlist ."+E))}else{if(d("#"+E).length){var y=(d("#"+E+" + td.product-name a:eq(0) img").attr("src"));if(!y.match(/_placeholders/)){y=y.split("/");y[y.length-2]="product60x60";y=y.join("/")}var A=d("#"+E+" + td.product-name a:eq(1)").html();var D=d("#"+E+" a").attr("href").split("/");var B=jQuery.inArray("product-finder",D);var z=k(D,B);var x=d('<li class="'+E+'"><div class="product-image"><img src="'+y+'" alt="" height="35" width="35" /></div><div class="details"><a class="remove" href="'+z+'">Remove</a>'+A+"</div></li>");u.push(x)}}});if(b.length%e!=0){var v=((Math.floor(b.length/e)+1)*e)-b.length;for(var t=1;t<=v;t++){u.push(g)}}if(u.length==0){d("#shortlist").remove();d(".compare-button a").remove()}else{if(d("#shortlist").length){d("#shortlist").empty().append("<ul></ul>")}else{d("#select-for-comparison").prepend('<div id="shortlist"><ul></ul></div>');var w=u[0].find("a").attr("href");w=w.replace(/\/product-finder\//g,"/compare/page-1/");d(".compare-button").prepend('<a href="'+w+'"><img alt="Compare Features" src="/assets/images/buttons/btn-compare-features.png" /></a>')}}jQuery.each(u,function(x,y){if(x>0&&x%4==0){d("#shortlist ul li:last").parent().after("</ul><ul>")}d("#shortlist ul:eq("+(Math.floor(x/e))+")").append(y)})}});jQuery(function(c){if(typeof pfSortOptions=="object"){var d=c("th.which-ratings");var b=c('<div class="sortby-ratings"><span><a href="#">Sort by:</a></span><ul></ul></div>');jQuery.each(pfSortOptions,function(){b.children("ul").append(this)});d.append(b);c(".sortby-ratings ul li:last-child").addClass("last");var a=c(".sortby-ratings ul");a.hide();if(jQuery.browser.msie&&parseInt(jQuery.browser.version)==6){c(".sortby-ratings ul").css("margin-right",125+"px")}c(".sortby-ratings span a").click(function(e){e.preventDefault();return false});c(".sortby-ratings").hoverIntent(function(){b=c(this);b.addClass("active");var g=b.find("span");var k=b.children("ul");var e=k.height()+b.outerHeight();var f=c(window).height();var h=c(window).scrollTop();var j=b.offset().top;g.css("border","1px solid #8C9DA5");if(e+j>f+h){if(jQuery.browser.msie){if(parseInt(jQuery.browser.version)==6){heightAdjust=-33}else{if(parseInt(jQuery.browser.version)==7){heightAdjust=-37}}}else{heightAdjust=-12}g.css("border-top","1px solid #FFFFFF");k.css("top",(e*-1-(g.outerHeight()+heightAdjust))+"px")}else{g.css("border-bottom","1px solid #FFFFFF");k.css("top",(g.outerHeight()-5)+"px")}k.show()},function(){c(this).find("span").css("border","1px solid #FFF");c(this).children("ul").hide()})}});
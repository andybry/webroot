var BANKLOOKUP={};BANKLOOKUP={bankAddressClearWarning:function(){$("#bankPostalAddress p.warning").remove()},bankAddressLookupFailure:function(b){var a;BANKLOOKUP.bankAddressClearWarning();if(b==="ajaxError"){a="Sorry, the remote lookup cannot be used at this time."}else{a="Sorry, no bank address details were found. Please check your sort code and account number."}$('<p class="warning">'+a+"</p>").insertAfter("#bankPostalAddress h4")},removeCommas:function(a){a=a.replace(/, ,/g,",");a=a.replace(/, </g,"<");return a},insertBankAddress:function(b){if(b.address&&b.address.addressLines){var h=b.address.addressLines,c=BANKLOOKUP.getAddressLineDetails(h,"bankName","").substring(0,31),g=BANKLOOKUP.getAddressLineDetails(h,"addressLine_1","").substring(0,27),e=BANKLOOKUP.getAddressLineDetails(h,"addressLine_2","").substring(0,31),d=BANKLOOKUP.getAddressLineDetails(h,"addressLine_3","").substring(0,31),f=BANKLOOKUP.getAddressLineDetails(h,"townCity","").substring(0,31),a=BANKLOOKUP.getAddressLineDetails(h,"postCode","");e+=d+f;e=BANKLOOKUP.removeCommas(e);$("#ddPreviewBankName").text(c);$("#ddPreviewBankAddress1").text(g);$("#ddPreviewBankAddress2").text(e);$("#ddPreviewBankPostCode").text(a);$("#ddPreviewBankNameField").attr("value",c);$("#ddPreviewBankAddress1Field").attr("value",g);$("#ddPreviewBankAddress2Field").attr("value",e);$("#ddPreviewBankPostCodeField").attr("value",a)}else{BANKLOOKUP.bankAddressLookupFailure("noResults")}},getBankAddress:function(b,a){$.ajax({type:"POST",url:"/address/bank-address/branch-lookup/",data:"sortCode="+b+"&accountNumber="+a.value,dataType:"json",success:function(c){BANKLOOKUP.insertBankAddress(c)},error:function(){BANKLOOKUP.bankAddressLookupFailure("ajaxError")}})},getAddressLineDetails:function(f,e,a){var g,c=a,b,d;if(f&&e){if($.isArray(f)){for(b=0;b<f.length;b+=1){g=f[b];d=g.lineType;if(d===e){c=g.details;if(!c||c===null){c=a}return c}}}else{c=f.details}}return c}};
"use strict";var SIGNUP={ADDRESS:{},PRINT:{},RESPONSYS:function(){},VALIDATION:{makeRequiredRule:function(){},fieldErrorMessages:{}}};SIGNUP={clientSideTest:"",giftSub:false,formErrors:{},initialPostTown:"",msgROIBeforeAddressLine1:'<p class="msgROIBeforeAddressLine1">Please enter your address</p>',processMsg:"",postCodeLookup:{searchHouseNumberSelector:"#lookupHouseNumber",searchPostcodeSelector:"#lookupPostCode",addressDropDownSelector:"#selectAddress",addressLine0Selector:"#addressLine1",addressLine1Selector:"#addressLine2",townSelector:"#postTown",postcodeSelector:"#postCode",errorMessages:{ERR01_AddressNotFound:"We were unable to find your address. Please try again or type your address below.",ERR02_TooManyResults:"Too many results.",ERR03_MissingHouseNumber:"Please enter a house number or name.",ERR04_MissingHouseNumberAndPostcode:"You need to provide your house name or number and postcode.",ERR05_MissingPostcode:"Please enter a UK postcode.",ERR06_InvalidPostcode:"Please enter a valid UK postcode.",ERR07_ConnectionProblem:"Sorry, there is a problem with the connection to the postcode lookup service.<br/>Please enter your details below instead.",ERRXX_UnknownProblem:"Sorry, an unknown problem occurred with the postcode lookup service.<br/>Please enter your details below instead."},helpMessages:{oneAddressFound:"We found one address matching the details you provided. If this address is not correct please edit the details below."}},country:{displayCountryText:'<div class="fieldWrapper displayCountryWrapper"><label>Country</label><span id="displayCountryLabel">[countryName]</span></div>',returnedFromServer:false,init:function(){if($("#addressLine1").val()!==""||$("#addressLine2").val()!==""||$("#postCode").val()!==""||$("#postTown").val()!==""){this.returnedFromServer=true;SIGNUP.country.select($("#countryId option:selected").val());$("#lookupPostCode").attr("value",$("#postCode").val());$("#addressLine1, #addressLine2, #postCode, #postTown").parent().show()}else{$("#addressLine1, #addressLine2, #postCode, #postTown").parent().hide()}},initGiftSub:function(){if(($("#addressLine1").val()!==""&&$("#addressLine1").val()!==$("#addressLine1").attr("placeholder"))||($("#addressLine2").val()!==""&&$("#addressLine2").val()!==$("#addressLine2").attr("placeholder"))||($("#postCode").val()!==""&&$("#postCode").val()!==$("#postCode").attr("placeholder"))||($("#postTown").val()!==""&&$("#postTown").val()!==$("#postTown").attr("placeholder"))){this.returnedFromServer=true;SIGNUP.country.select($("#countryId option:selected").val());$("#lookupPostCode").attr("value",$("#postCode").val());$("#addressLine1, #addressLine2, #postCode, #postTown").parent().show()}else{$("#addressLine1, #addressLine2, #postCode, #postTown").parent().hide();if($("#addressLine1").hasClass("fieldError")||$("#addressLine2").hasClass("fieldError")){$("#lookupHouseNumber").addClass("fieldError").after('<img src="/assets/images/content/gift-subscriptions/form-cross.png">')}if($("#postCode").hasClass("fieldError")||$("#postTown").hasClass("fieldError")){$("#lookupPostCode").addClass("fieldError").after('<img src="/assets/images/content/gift-subscriptions/form-cross.png">')}}if(($("#addressLine1To").val()!==""&&$("#addressLine1To").val()!==$("#addressLine1To").attr("placeholder"))||($("#addressLine2To").val()!==""&&$("#addressLine2To").val()!==$("#addressLine2To").attr("placeholder"))||($("#postCodeTo").val()!==""&&$("#postCodeTo").val()!==$("#postCodeTo").attr("placeholder"))||($("#postTownTo").val()!==""&&$("#postTownTo").val()!==$("#postTownTo").attr("placeholder"))){this.returnedFromServer=true;SIGNUP.country.select($("#countryIdTo option:selected").val());$("#lookupPostCodeTo").attr("value",$("#postCodeTo").val());$("#addressLine1To, #addressLine2To, #postCodeTo, #postTownTo").parent().show()}else{$("#addressLine1To, #addressLine2To, #postCodeTo, #postTownTo").parent().hide();if($("#addressLine1To").hasClass("fieldError")||$("#addressLine2To").hasClass("fieldError")){$("#lookupHouseNumberTo").addClass("fieldError").after('<img src="/assets/images/content/gift-subscriptions/form-cross.png">')}if($("#postCodeTo").hasClass("fieldError")||$("#postTownTo").hasClass("fieldError")){$("#lookupPostCodeTo").addClass("fieldError").after('<img src="/assets/images/content/gift-subscriptions/form-cross.png">')}}$("#alreadyRequestedEmailAddress").val("true")},select:function(a){if(typeof a==="undefined"||a===null){return}if(a.toLowerCase()==="republic of ireland"){SIGNUP.country.ROI(a)}else{SIGNUP.country.UK(a)}},ROI:function(c){var b=$("#addressLine1").parent().html(),a=$('label[for="postCode"]');$("#lookupPostCode, #lookupHouseNumber, #findAddressButton, #selectAddress").parent().hide();$("#addressIntro2").hide();if(b.indexOf(SIGNUP.msgROIBeforeAddressLine1)===-1){$("#addressLine1").parent().parent().before(SIGNUP.msgROIBeforeAddressLine1)}$("#countryId").blur();a.find(".mandatory").hide();a.append('<span class="not-mandatory">&nbsp;&nbsp;</span>');delete SIGNUP.VALIDATION.validationRules.postCode;delete SIGNUP.VALIDATION.validationRules.lookupPostCode;if(!this.returnedFromServer){$("#addressLine1, #addressLine2, #postCode, #postTown").val("")}else{this.returnedFromServer=false}$("#addressLine1, #addressLine2, #postCode, #postTown").parent().show();SIGNUP.country.displayLabel(c)},UK:function(b){var a=$('label[for="postCode"]');$("#lookupPostCode, #lookupHouseNumber, #findAddressButton").parent().show();$("#addressIntro1, #addressIntro2").show();$("p.msgROIBeforeAddressLine1").remove();a.find(".not-mandatory").hide();a.find(".mandatory").show();SIGNUP.VALIDATION.validationRules.postCode=SIGNUP.addressRequired;SIGNUP.VALIDATION.validationRules.lookupPostCode=SIGNUP.VALIDATION.postCodeRequired;if(this.returnedFromServer){this.returnedFromServer=false}else{$("#addressLine1, #addressLine2, #postCode, #postTown").val("");$("#addressLine1, #addressLine2, #postCode, #postTown").parent().hide()}SIGNUP.country.displayLabel(b)},displayLabel:function(a){if($("#displayCountryLabel").length>0){$("#displayCountryLabel").html(a)}else{$("#postCode").parent().parent().after(SIGNUP.country.displayCountryText.replace("[countryName]",a))}}},removeErrorField:function(a){a.removeClass("error").removeClass("fieldError");a.parents("div.fieldWrapper, div.fieldWrapperInline").find(".error").remove().end().find("img").remove()},applyErrorField:function(a,d){var c,b;if(SIGNUP.VALIDATION.validationRules){b=SIGNUP.VALIDATION.validationRules[a.attr("id")];c=b(a.val())}else{c=a.attr("title")}$('<p class="error">'+c+"</p>").prependTo(d)},processSignup:function(){window.scrollTo(0,0);$("#signUp").fadeTo("normal",0.2);$(".sign-up").fadeTo("normal",0.2);$("#processing").show();$("select").hide();$("#confirmOrder").click(function(a){a.preventDefault()})},boxNumbers:function(a){var c,b="";for(c=0;c<a.length;c+=1){b+="<span>"+a.substring(c,c+1)+"</span>"}return b},removeDuplicates:function(b){var e,c="",d,a=[];for(d=0;d<b.length;d+=1){e=b[d];if(e!==c){a[a.length]=e}c=e}return a},removeThrobber:function(){$("#throbber").remove()},displayThrobber:function(){SIGNUP.removeThrobber();$("#findAddressButton").after('<img id="throbber" src="/assets/images/content/sign-up/throbber.gif" alt=""/>')},removeError:function(){$("#errorMessage").remove();$("#lookupPostCode").parent().find(".error").remove();if(SIGNUP.giftSub){$("#lookupHouseNumber, #lookupPostCode, #selectAddress, #addressLine1, #addressLine2, #postCode, #postTown").removeClass("fieldError").parent().find("img").remove()}},displayLocalError:function(b,a,c){var d=b;SIGNUP.removeThrobber();if(SIGNUP.postCodeLookup.errorMessages[b]){d=SIGNUP.postCodeLookup.errorMessages[b]}else{d=SIGNUP.postCodeLookup.errorMessages.ERRXX_UnknownProblem}if(c){SIGNUP.removeError()}if(SIGNUP.clientSideTest===true){SIGNUP.VALIDATION.validateField(a,false)}else{b="";$(a).parent().prev().append('<div id="errorMessage"><p class="error">'+d+"</p></div>")}if(b===""||b==="ERR01_AddressNotFound"||b==="ERR07_ConnectionProblem"||b==="ERRXX_UnknownProblem"){$("#addressLine1, #addressLine2, #postCode, #postTown").parent().show();SIGNUP.country.displayLabel("United Kingdom")}},displayRemoteError:function(a){SIGNUP.displayLocalError(a.responseText,SIGNUP.postCodeLookup.addressDropDownSelector)},showAddressFields:function(){$("#addressLine1, #addressLine2, #postCode, #postTown").parent().show();if(SIGNUP.giftSub){if($("#addressLine1").val()!==""&&$("#addressLine1").val()!==$("#addressLine1").attr("placeholder")){$("#addressLine1").removeClass("placeholder")}if($("#addressLine2").val()!==""&&$("#addressLine2").val()!==$("#addressLine2").attr("placeholder")){$("#addressLine2").removeClass("placeholder")}if($("#postCode").val()!==""&&$("#postCode").val()!==$("#postCode").attr("placeholder")){$("#postCode").removeClass("placeholder")}if($("#postTown").val()!==""&&$("#postTown").val()!==$("#postTown").attr("placeholder")){$("#postTown").removeClass("placeholder")}}},showSelectField:function(){$("#selectAddress").parent().show()},getAddressLineDetails:function(f,e,a){var g,c=a,b,d;if(f&&e){if($.isArray(f)){for(b=0;b<f.length;b+=1){g=f[b];d=g.lineType;if(d===e){c=g.details;if(!c||c===null){c=a}return c}}}else{c=f.details}}return c},populateDropDownWithResults:function(c){var a,b=$(SIGNUP.postCodeLookup.addressDropDownSelector);$(b).children().remove();$(b).append('<option value="-1">Please select...</option>');if($.isArray(c)){for(a=0;a<c.length;a+=1){$(b).append('<option value="'+c[a].addressId+'">'+SIGNUP.getAddressLineDetails(c[a].addressLines,"singleLineAddress")+"</option>")}}else{$(b).append('<option value="'+c.addressId+'">'+SIGNUP.getAddressLineDetails(c.addressLines,"singleLineAddress")+"</option>")}},populateAddressDetails:function(b){var f=b.addressLines,e=SIGNUP.getAddressLineDetails(f,"addressLine_1","").substring(0,27),d=SIGNUP.getAddressLineDetails(f,"addressLine_2","").substring(0,31),c=SIGNUP.getAddressLineDetails(f,"townCity","").substring(0,31),a=SIGNUP.getAddressLineDetails(f,"postCode","");$(SIGNUP.postCodeLookup.addressLine0Selector).val(e);$(SIGNUP.postCodeLookup.addressLine1Selector).val(d);$(SIGNUP.postCodeLookup.townSelector).val(c);$(SIGNUP.postCodeLookup.postcodeSelector).val(a);SIGNUP.ADDRESS.lookupCityValue=c;SIGNUP.showAddressFields()},displaySelectedAddress:function(a){SIGNUP.populateAddressDetails(a.address)},clearSelectedAddress:function(){$(SIGNUP.postCodeLookup.addressLine0Selector).val("");$(SIGNUP.postCodeLookup.addressLine1Selector).val("");$(SIGNUP.postCodeLookup.townSelector).val("");$(SIGNUP.postCodeLookup.postcodeSelector).val("")},displayOneAddress:function(a){$("#lookupHouseNumber, #lookupPostCode, #findAddressButton, #outsideUKLink").parent().remove();$("#selectAddress").parent().remove();$("#addressIntro1").remove();$("#addressIntro2").html('<p class="alertMsg"><img height="19" width="21" alt="tick" src="/assets/images/content/sign-up/correct-alert.png"/>'+SIGNUP.postCodeLookup.helpMessages.oneAddressFound+"</p>");$("#lookupCountry").next().hide();$("#country, #lookupCountry").hide();$("#countryDisplay").html("");$("#countryDisplay").parent().show();SIGNUP.populateAddressDetails(a.address);SIGNUP.country.displayLabel($("#countryId option:selected").text())},lookupAndShowAddress:function(a,d){var c=(d)?SIGNUP.displayOneAddress:SIGNUP.displaySelectedAddress,b="/address/address/"+a;SIGNUP.removeError();SIGNUP.clearSelectedAddress();if($(SIGNUP.postCodeLookup.addressDropDownSelector).val()!=="-1"){$.ajax({type:"GET",dataType:"json",timeout:5000,url:b,success:c,error:SIGNUP.displayRemoteError})}},addressSelected:function(){var a=$(SIGNUP.postCodeLookup.addressDropDownSelector+" option:selected").val();SIGNUP.lookupAndShowAddress(a,false)},clearAddressesDropDown:function(){$(SIGNUP.postCodeLookup.addressDropDownSelector).children().remove()},DisplayPostCodeSearchResults:function(a){var b=a.addressList.addresses;this.showResults=function(){if($.isArray(b)){SIGNUP.populateDropDownWithResults(b);SIGNUP.showSelectField();SIGNUP.showAddressFields()}else{SIGNUP.lookupAndShowAddress(b.addressId,true)}SIGNUP.removeThrobber()}},delayDisplayResults:function(a){clearTimeout(SIGNUP.dtimeout);var b=new SIGNUP.DisplayPostCodeSearchResults(a);SIGNUP.dtimeout=setTimeout(b.showResults,200)},lookupAddresses:function(){$("#findAddressButton").blur();$("#selectAddress").parent().hide();SIGNUP.clientSideTest=false;if(!SIGNUP.VALIDATION.validateInputs()){return}SIGNUP.removeError();SIGNUP.displayThrobber();SIGNUP.clearAddressesDropDown();var c=$(SIGNUP.postCodeLookup.searchHouseNumberSelector).val(),b=$(SIGNUP.postCodeLookup.searchPostcodeSelector).val();if(SIGNUP.giftSub){if(c===$(SIGNUP.postCodeLookup.searchHouseNumberSelector).attr("placeholder")){c=""}if(b===$(SIGNUP.postCodeLookup.searchPostcodeSelector).attr("placeholder]")){b=""}}var a="/address/addresses/"+(c===""?"*":c)+"/"+(b===""?" ":b)+"/";$.ajax({type:"GET",dataType:"json",timeout:5000,url:a,success:SIGNUP.delayDisplayResults,error:SIGNUP.displayRemoteError})},showHelp:function(b,d){var a=$(b).height(),c=$(b).offset().top;if(SIGNUP.hideHelpTimer){clearTimeout(SIGNUP.hideHelpTimer);SIGNUP.hideHelpTimer=null}SIGNUP.helpArrow.css("top",c+"px");SIGNUP.helpBrace.height(a);SIGNUP.helpArrow.height(a).show();$("#contextualHelp").find("div").html(d).end().css("top",c+"px").show()},showHelpForField:function(e){var c=$(e),b=c.parents("div.helpWrapper"),d=".h_"+e.id,f=$("<p></p>"),a=$(d+" + p.helpText").html();f.html(a);if(a){SIGNUP.showHelp(b,f)}},switchPayment:function(){if($("select#paymentMethod").val()==="paymentCC"){$("#creditCardSection").show().removeClass("childrenAreHidden");$("#creditCardPreview, #detailsCC").show();$("#directDebitSection").hide().addClass("childrenAreHidden");$("#directDebitPreview, #detailsDD").hide()}else{$("#creditCardSection").hide().addClass("childrenAreHidden");$("#creditCardPreview, #detailsCC").hide();$("#directDebitSection").show().removeClass("childrenAreHidden");$("#directDebitPreview, #detailsDD").show()}},ddPreviewSortCode:function(){var a;if(SIGNUP.VALIDATION.allSortCodeValid()){a=$.map(["ddSort1Field","ddSort2Field","ddSort3Field"],function(c){return $("#"+c).val()});$("#ddPreviewSortCode").html(SIGNUP.boxNumbers(a.join("")));var b=document.getElementById("ddNumberField");if(SIGNUP.VALIDATION.isValid(b)){BANKLOOKUP.getBankAddress(a.join(""),b)}}else{$("#ddPreviewSortCode").html("")}},init:function(){$("#select-button, div.help-area").remove();$("#tsCs, .showForJS").show();$("#supportingInformation, #offerSummary, div.allHelpText, .showForNonJS").hide();$("#closeWindow").click(function(){self.close();return false});$("#printNow").click(function(){self.print();return false});$("#signUp").append('<div id="contextualHelp"><div></div></div>').find("#contextualHelp").hide();SIGNUP.helpArrow=$('<div id="helpArrow"></div>').css({position:"absolute",left:"482px",top:"-900px",height:"0px",width:"20px"}).hide().appendTo("#signUp");SIGNUP.helpBrace=$('<div id="helpArrowBrace"></div>').css({width:"5px",height:"100%","border-right":"1px solid #ccc","border-bottom":"1px solid #ccc","border-top":"1px solid #ccc"}).appendTo(SIGNUP.helpArrow);SIGNUP.helpBar=$('<div id="helpArrowBar"></div>').css({width:"15px",height:"0px","border-top":"1px solid #ccc",position:"absolute",top:"50%",left:"5px"}).appendTo(SIGNUP.helpArrow);SIGNUP.processMsg=['<div id="processing">',"  <p>",'    <img src="/assets/images/icons/processing-spinner.gif"','         height="32" width="32" alt="processing form" />',"  </p>","  <p>Processing your registration...</p>","</div>"].join(" ");$(SIGNUP.processMsg).appendTo("#content").hide();$(".no-label").css("margin-bottom","4px");$("#registrationForm").submit(function(b){var g=$(":input").not(".addressDetail:hidden"),e=true,f,d=[],c,a;g.each(function(j,h){if(!SIGNUP.VALIDATION.validateField(h,"dueToSubmit")){e=false;if(h.id){d.push(SIGNUP.formErrors[h.id])}}});if(!e){$("#form-error-signup").html("");b.preventDefault();$("div#youNeedToComplete").remove();f=$(strErrorMessageWrapPrefix+"<div><p>One or more fields have been missed or completed incorrectly, these are listed below. Please complete or amend appropriately.</p></div>"+strErrorMessageWrapSuffix);c=$("input#confirmOrder");a=$('<ul class="standard"></ul>');f.prependTo("#form-error-signup");d=SIGNUP.removeDuplicates(d);$.each(d,function(j,h){a.append($("<li></li>").text(h))});f.append(a);window.scrollTo(0,0);return false}else{$("#youNeedToComplete, #contextualHelp, #helpArrow").hide();SIGNUP.processSignup();return true}});if(document.getElementById("postTown")){SIGNUP.initialPostTown=document.getElementById("postTown").value}},initStart:function(){$("#emailAddress, #emailAddress2").blur(function(){SIGNUP.RESPONSYS(false)});$("#contact-me").click(function(){SIGNUP.RESPONSYS(true)});$("#TandCBack").find("#closeWindow").text("Close window");$("#TandCBack").find("a").attr("href","#");$("#findAddressButton").click(SIGNUP.lookupAddresses);$(SIGNUP.postCodeLookup.addressDropDownSelector).change(SIGNUP.addressSelected);$("#countryId").change(function(){SIGNUP.country.select($(this).val())});if(SIGNUP.giftSub){SIGNUP.country.initGiftSub()}else{SIGNUP.country.init()}SIGNUP.ADDRESS.setPostTownErrorStatus()},initCC:function(){$("#cPreviewCardType").text($("#ccCardTypeField option:selected").text());$("#ccCardTypeField").blur(function(){$("#cPreviewCardType").text($("#ccCardTypeField option:selected").text())});$("#creditCardName").blur(function(){$("#cPreviewName").text($(this).val())});$("#ccNumberField").blur(function(){$("#cPreviewNumber").text($(this).val())});$("#ccEndMonthField").blur(function(){$("#cPreviewMonthExpiry").text($(this).val())});$("#ccEndYearField").blur(function(){$("#cPreviewYearExpiry").text($(this).val())})},initDD:function(){$("input#ddNameField").blur(function(){$("#ddPreviewName").text($(this).val())});$("input#ddNameField").blur();$("input#ddNumberField").blur(function(){$("#ddPreviewNumber").html(SIGNUP.boxNumbers($(this).val()))});$("input#ddNumberField").blur();$("#ddSort1Field, #ddSort2Field, #ddSort3Field").blur(SIGNUP.ddPreviewSortCode);SIGNUP.ddPreviewSortCode();$("input#firstnameField, input#surnameOrCompany").change(function(){$("input#accountName").val($("input#foreName").val()+" "+$("input#surnameOrCompany").val());$("#ddPreviewName").text($("input#accountName").val())})},initGiftSub:function(){$(".hideLabel").hide();$("#signup-email-confirm").hide();$("[placeholder]").focus(function(){var a=$(this);if(a.val()===a.attr("placeholder")){a.val("");a.removeClass("placeholder")}}).blur(function(){var a=$(this);if(a.val()===""||a.val()===a.attr("placeholder")){a.addClass("placeholder");a.val(a.attr("placeholder"))}}).blur();$("#registrationForm").submit(function(){$(this).find("[placeholder]").each(function(){var b=$(this);if(b.val()==b.attr("placeholder")){b.val("")}});if($("#emailAddressTo").val()===""){var a=this;$("#signup-email-confirm").dialog({title:"Recipient email request",resizable:false,width:400,dialogClass:"signup-email-confirm",modal:true,position:["center",100],buttons:{"Add recipient email":function(){$(this).dialog("close");$("[placeholder]").blur();$("#emailAddressTo").focus()},"Continue anyway":function(){a.submit()}}});$("#signup-email-confirm").dialog("open");return false}})}};SIGNUP.VALIDATION={makeRequiredRule:function(a,b){var d,e=$(a).val();try{d=SIGNUP.VALIDATION.fieldErrorMessages[b]}catch(c){}if(!jQuery.trim(e)){return d}else{return""}},fieldErrorMessages:{addressLine1:"Please enter address line 1.",ccNumberField:"Please enter the card number.",ccNumberFieldLenghth:"The card number must be 13-19 numeric characters in length.",ccEndMonthField:"Please select an expiry date.",ccEndYearField:"Please select an expiry date.",countryId:"Please select a country.",creditCardName:"Please enter the name on the card.",ddNameField:"Please enter the name of the account holder.",ddNumberField:"Please enter an account number.",ddNumberFieldMsg2:"Please enter a valid 8 digit account number.",ddSortField:"Please enter a valid sort code.",emailAddressUsername:"If you want to use an email address as your username, it must be the same as the one given in the Email address field.",emailAddress:"Please enter your email address.",emailAddressInvalid:"Please enter a valid email address.",emailAddress2:"This email address does not match that given above.",emailAddressMsg2:"Please re-enter your email address.",firstName:"Please enter first name.",houseNumber:SIGNUP.postCodeLookup.errorMessages.ERR03_MissingHouseNumber,invalidPostCode:SIGNUP.postCodeLookup.errorMessages.ERR06_InvalidPostcode,lastName:"Please enter last name.",loginPassword:"Please enter a password.",loginPassword2:"This password does not match that given above.",loginPasswordMsg2:"Please re-enter your password.",postTown:"Please enter a Town or City.",postCode:SIGNUP.postCodeLookup.errorMessages.ERR05_MissingPostcode,titleField:"Please select a title.",tsandcs:"You must agree to our Terms & Conditions.",username:"Please enter a username.",usernameMsg2:"Your username must be at least 6 characters in length.",paymentMethod:"Please select a payment method."},isUKPostcode:function(a){var b=new RegExp("^[A-Z]{1,2}[0-9R][0-9A-Z]?[ ]?[0-9][ABD-HJLNP-UW-Z]{2}$","i");return b.test(a)},isUKForcesPostcode:function(a){var b=new RegExp("^(BFPO[ ]?[0-9]{1,4})$","i");return b.test(a)},postCodeRequired:function(a){if(a.length===0){return SIGNUP.VALIDATION.fieldErrorMessages.postCode}if((!SIGNUP.VALIDATION.isUKPostcode(a)&&!SIGNUP.VALIDATION.isUKForcesPostcode(a))){return SIGNUP.VALIDATION.fieldErrorMessages.invalidPostCode}},allSortCodeValid:function(){var a=$.map(["ddSort1Field","ddSort2Field","ddSort3Field"],function(b){return(/^\d{2}$/).exec($("#"+b).val())});return(a.length===3)},sortCodeValid:function(){if(!SIGNUP.VALIDATION.allSortCodeValid()){return SIGNUP.VALIDATION.fieldErrorMessages.ddSortField}},endDateValid:function(){if($("#ccEndMonthField").val()===""||$("#ccEndYearField").val()===""){return SIGNUP.VALIDATION.fieldErrorMessages.ccEndMonthField}},validateEmailAddress:function(a,b){if(!b){b="emailAddress"}if(a.length===0&&b==="emailAddress"){return SIGNUP.VALIDATION.fieldErrorMessages.emailAddress}if(!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a)||(a.indexOf("/")>0)){switch(b){case"username":return SIGNUP.VALIDATION.fieldErrorMessages.emailAddressUsername;default:return SIGNUP.VALIDATION.fieldErrorMessages.emailAddressInvalid}}},validationRules:{titleField:function(){return SIGNUP.VALIDATION.makeRequiredRule("#titleField","titleField")},firstName:function(){return SIGNUP.VALIDATION.makeRequiredRule("#firstName","firstName")},lastName:function(){return SIGNUP.VALIDATION.makeRequiredRule("#lastName","lastName")},addressLine1:function(){return SIGNUP.VALIDATION.makeRequiredRule("#addressLine1","addressLine1")},postTown:function(){SIGNUP.ADDRESS.checkCity();return SIGNUP.VALIDATION.makeRequiredRule("#postTown","postTown")},postCode:function(a){return SIGNUP.VALIDATION.postCodeRequired(a)},lookupPostCode:function(a){return SIGNUP.VALIDATION.postCodeRequired(a)},countryId:function(){return SIGNUP.VALIDATION.makeRequiredRule("#countryId","countryRequired")},emailAddress:function(a){return SIGNUP.VALIDATION.validateEmailAddress(a)},emailAddress2:function(a){if(a!==$("input#emailAddress").val()){return SIGNUP.VALIDATION.fieldErrorMessages.emailAddress2}if(!$.trim(a)){return SIGNUP.VALIDATION.fieldErrorMessages.emailAddressMsg2}},loginPassword:function(a){if(a.length<6||a.length>20){return SIGNUP.VALIDATION.fieldErrorMessages.loginPassword}},loginPassword2:function(a){if(a!==$("input#loginPassword").val()){return SIGNUP.VALIDATION.fieldErrorMessages.loginPassword2}if(!$.trim(a)){return SIGNUP.VALIDATION.fieldErrorMessages.loginPasswordMsg2}},username:function(){var a=$("#username").val();if(!$.trim(a)){return SIGNUP.VALIDATION.fieldErrorMessages.username}if(a.length<6){return SIGNUP.VALIDATION.fieldErrorMessages.usernameMsg2}if(a.indexOf("@")>-1){return SIGNUP.VALIDATION.validateEmailAddress(a,"username")}},ddNameField:function(){return SIGNUP.VALIDATION.makeRequiredRule("#ddNameField","ddNameField")},ddNumberField:function(a){if(!$.trim(a)){return SIGNUP.VALIDATION.fieldErrorMessages.ddNumberField}if(!/^\d{8}$/.exec(a)){return SIGNUP.VALIDATION.fieldErrorMessages.ddNumberFieldMsg2}},ddSort1Field:function(){return SIGNUP.VALIDATION.sortCodeValid()},ddSort2Field:function(){return SIGNUP.VALIDATION.sortCodeValid()},ddSort3Field:function(){return SIGNUP.VALIDATION.sortCodeValid()},creditCardName:function(){return SIGNUP.VALIDATION.makeRequiredRule("#creditCardName","creditCardName")},ccNumberField:function(a){if(!$.trim(a)){return SIGNUP.VALIDATION.fieldErrorMessages.ccNumberField}a=a.replace(/\s/g,"");if(!/^\d{13,19}$/.exec(a)){return SIGNUP.VALIDATION.fieldErrorMessages.ccNumberFieldLenghth}a=a.replace(/\s/g,"");if(a.length<13||a.length>19){return SIGNUP.VALIDATION.fieldErrorMessages.ccNumberField}},ccEndMonthField:function(){return SIGNUP.VALIDATION.endDateValid()},ccEndYearField:function(){return SIGNUP.VALIDATION.endDateValid()},tsandcs:function(){if(!$("input#tsandcs").get(0).checked){return SIGNUP.VALIDATION.fieldErrorMessages.tsandcs}},creditDebitCard:function(){if($("#payment-method").find("input:radio:checked").length===0){return SIGNUP.VALIDATION.fieldErrorMessages.paymentMethod}}},validateField:function(d){var c,a=$(d),b,e;SIGNUP.removeErrorField(a);if(a.parents(".childrenAreHidden").length>0){delete SIGNUP.formErrors[a.attr("id")];return true}if(SIGNUP.VALIDATION.validationRules){b=SIGNUP.VALIDATION.validationRules[a.attr("id")]}if(typeof b==="undefined"){return true}c=b(a.val());e=a.parents("div.fieldWrapper, div.fieldWrapperInline");if(c){SIGNUP.formErrors[a.attr("id")]=c;SIGNUP.applyErrorField(a,e);return false}else{delete SIGNUP.formErrors[a.attr("id")];return true}},isValid:function(c){var a=$(c),b=SIGNUP.VALIDATION.validationRules[a.attr("id")];if(typeof b==="undefined"){return true}if(b(a.val())){return false}return true},validateInputs:function(){var a=true,b=$(SIGNUP.postCodeLookup.searchPostcodeSelector).val().replace(/^\s+|\s+$/g,"");if(SIGNUP.giftSub){if(b===$(SIGNUP.postCodeLookup.searchPostcodeSelector).attr("placeholder")){b=""}}if(b===""){SIGNUP.clientSideTest=true;SIGNUP.displayLocalError(SIGNUP.postCodeLookup.errorMessages.ERR05_MissingPostcode,SIGNUP.postCodeLookup.searchPostcodeSelector,true);a=false}else{if(!SIGNUP.VALIDATION.isUKPostcode(b)&&!SIGNUP.VALIDATION.isUKForcesPostcode(b)){SIGNUP.clientSideTest=true;SIGNUP.displayLocalError(SIGNUP.postCodeLookup.errorMessages.ERR06_InvalidPostcode,SIGNUP.postCodeLookup.searchPostcodeSelector,true);a=false}}return a}};SIGNUP.ADDRESS={addressIntro1:'<p id="addressIntro1">Please select your country of residence</p>',addressIntro2:'<p id="addressIntro2">Use the quick address search facility and select your address from the results</p>',lookupHouseNumHTML:'<div class="fieldWrapper"><label for="lookupHouseNumber">House number or name &nbsp;</label><input maxlength="27" type="text" name="lookupHouseNumber" id="lookupHouseNumber" class="text skipValidation" /></div>',lookupPostCode:'<div class="fieldWrapper"><label for="lookupPostCode">Postcode (e.g. SE5 7TR) <span class="mandatory">*</span></label><input maxlength="8" type="text" name="lookupPostCode" id="lookupPostCode" class="text"/></div><div class="fieldWrapper find-address"><a href="#" id="findAddressButton" title="Find address" onclick="return false;"><img src="/assets/images/content/sign-up/btn-find-address.png" alt="Find address" height="26" width="108"/></a></div><div class="fieldWrapper"><p class="qasResultMessage">Please select your address from the drop-down, if it is not available then select the closest match and edit it</p><label for="selectAddress">Select a possible match <span class="mandatory">*</span></label><select id="selectAddress"></select></div>',lookupHouseNumHTMLGiftSub:'<div class="fieldWrapper"><label for="lookupHouseNumber" class="hideLabel">House number or name</label><input maxlength="27" type="text" name="lookupHouseNumber" id="lookupHouseNumber" placeholder="House number or name" class="text skipValidation" /></div>',lookupPostCodeGiftSub:'<div class="fieldWrapper"><label for="lookupPostCode" class="hideLabel">Postcode (e.g. SE5 7TR)</label><input maxlength="8" type="text" name="lookupPostCode" id="lookupPostCode" placeholder="Postcode (e.g. SE5 7TR)" class="text"/></div><div class="fieldWrapper find-address"><a href="#" id="findAddressButton" title="Find address" onclick="return false;" class="signup-button grey small left">Find address</a></div><div class="fieldWrapper"><p class="qasResultMessage">Please select your address from the drop-down, if it is not available then select the closest match and edit it</p><label for="selectAddress" class="hideLabel">Select a possible match</label><select id="selectAddress"></select></div>',setPostTownErrorStatus:function(){var a,b=document.getElementById("postTown").parentNode.getElementsByTagName("p");if(b.length>0){for(a=0;a<b.length;a=a+1){if(b[a].className.indexOf("error")>-1){SIGNUP.ADDRESS.isPostTownAnError="1";break}}}else{SIGNUP.ADDRESS.isPostTownAnError="0"}},isPostTownAnError:"",checkCity:function(){var e=document.getElementById("cityModified"),b=document.getElementById("postTown").value,a=(SIGNUP.initialPostTown.length>0)?SIGNUP.initialPostTown:SIGNUP.ADDRESS.lookupCityValue,d=SIGNUP.ADDRESS.lookupCityValue||"",f=SIGNUP.ADDRESS.isPostTownAnError,c={"0000":true,"0011":false,"0010":true,"1000":true,"1100":true,"1011":false,"0100":false};f+=(a===b)?"1":"0";f+=(d.length>0)?"1":"0";f+=(d===b)?"1":"0";e.value=c[f]||true},init:function(){var a=$("#addressDetails").parent(),b=$("#countryWrapper").html();$("#countryWrapper").children().remove();$("#countryWrapper").hide();a.prepend(SIGNUP.ADDRESS.addressIntro1+b+SIGNUP.ADDRESS.addressIntro2+SIGNUP.ADDRESS.lookupHouseNumHTML+SIGNUP.ADDRESS.lookupPostCode);$("#selectAddress, #addressLine1, #addressLine2, #postCode, #postTown").parent().hide();$("#outsideUKLink").css("display","inline")},initGiftSub:function(){var a=$("#addressDetails").parent(),b=$("#countryWrapper").html();$("#countryWrapper").children().remove();$("#countryWrapper").hide();a.prepend(SIGNUP.ADDRESS.addressIntro1+b+SIGNUP.ADDRESS.addressIntro2+SIGNUP.ADDRESS.lookupHouseNumHTMLGiftSub+SIGNUP.ADDRESS.lookupPostCodeGiftSub);$("#selectAddress, #addressLine1, #addressLine2, #postCode, #postTown").parent().hide()}};SIGNUP.PRINT={ddSetup:function(){var a=$("#viewPrintable");a.find("p.printable span").html('<a href="#" id="printDD">Print your Direct Debit instruction</a>');a.click(function(){self.print();return false})}};SIGNUP.RESPONSYS=function(o){var d,b,e,k,j,l,m,c,p,i=true,g,h,f,a,n;k=$("#emailAddress").val();j=$("#emailAddress2").val();h=$("#sourceCode");f=h.attr("value");if(h.val().indexOf("processed")>0){i=false}if(o){i=true;f=f.replace(/processed/g,"")}if(k!==j){i=false}if(i){e=SIGNUP.VALIDATION.validateEmailAddress($("#emailAddress").val());if(typeof e==="undefined"){g="";n=$("#titleField").val();l=$("#firstName").val();a=$("#lastName").val();d=$("#addressLine1").val();b=$("#addressLine2").val();p=$("#postTown").val();m=$("#postCode").val();c=($("#contact-me").attr("checked")==="checked")?"Y":"N";g+="sourceCode="+f+"&customer.title="+n+"&customer.foreName="+l+"&customer.surnameOrCompany="+a+"&customer.addressLine1="+d+"&customer.addressLine2="+b+"&customer.postTown="+p+"&customer.postCode="+m+"&customer.emailAddress="+k+"&customer.permitPromote="+c;$.ajax({type:"POST",url:"/account/responsys",data:g,success:function(){h.attr("value",f+"processed")}})}}};var MODALWINDOW={dialogboxPrintStylesheet:'<link type="text/css" rel="stylesheet" media="print" href="//www.staticwhich.co.uk/assets/5.9.4-SNAPSHOT/styles/print-dialogbox.css"/>',addDialogboxPrintStylesheet:function(){if($('head link[href="'+MODALWINDOW.css_thickboxPrintStylesheet+'"]').length===0){$("head").append(MODALWINDOW.dialogboxPrintStylesheet)}},TERMS:{YQL:"https://query.yahooapis.com/v1/public/yql?q=SELECT%20*%20FROM%20html%20WHERE%20url%3D%22http%3A%2F%2Fwww.which.co.uk%2Fterms-and-conditions%2F%22%20AND%20xpath%3D%22%2F%2Fdiv[%40id%3D%27content%27]%22&format=xml&callback=MODALWINDOW.TERMS.getTermsConditions",getTermsConditions:function(b){var a=b.results[0];$("#content").append('<div id="terms-and-conditions-content" style="display:none;">'+a+"</div>");$("#terms-and-conditions-content").find("a").attr("target","_blank");$("#terms-and-conditions-content a[href^=#]").removeAttr("target")},init:function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=MODALWINDOW.TERMS.YQL;document.getElementById("content").appendChild(a);$("#terms-and-conditions").attr("href","#terms-and-conditions-content")}},ALREADYMEMBER:{YQL:"https://query.yahooapis.com/v1/public/yql?q=SELECT%20*%20FROM%20html%20WHERE%20url%3D%22http%3A%2F%2Fwww.which.co.uk%2Fsignup%2Fwhich-magazine-members%2F%22%20AND%20xpath%3D%22%2F%2Fdiv[%40id%3D%27content%27]%22&format=xml&callback=MODALWINDOW.ALREADYMEMBER.getPageContent",getPageContent:function(b){var a=b.results[0];$("#content").append('<div id="already-member-content" style="display:none;">'+a+"</div>");$("#already-member-content").find("a").attr("target","_top");$("#already-member-content a[href^=#]").removeAttr("target")},init:function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src=MODALWINDOW.ALREADYMEMBER.YQL;document.getElementById("content").appendChild(a);$("#existingWexSignup a").attr("href","#already-member-content").addClass("dialogbox").attr("id","already-member")}},dialogSetup:function(){$("#content").find("a.dialogbox").each(function(){var c=$("<div></div>").append($(SIGNUP.processMsg).clone()),b,a;a=$(this).one("click",function(){b=$("#"+a.attr("href").split("#")[1]);var d=function(){return window.innerWidth<650?"auto":650};c.html(b.html()).dialog({title:"Which Online Trial Sign Up",width:d,minHeight:250,maxHeight:500,dialogClass:"which-dialog",modal:true,open:function(){c.dialog("option","buttons",[{text:"Close",click:function(){$(this).dialog("close")}}]);var e=$(this).parent().find(".ui-widget-header");if(e.find("a.print-dialog").length===0){e.append('<a class="print-dialog" onclick="window.print();return false" href="#">Print this page</a>');$(this).find(".back-to-top").remove();MODALWINDOW.addDialogboxPrintStylesheet()}}});a.click(function(){c.dialog("open");return false});return false})})}};$(document).ready(function(){if(document.getElementById("signup-gift")){SIGNUP.giftSub=true;SIGNUP.initGiftSub()}else{SIGNUP.giftSub=false;SIGNUP.init()}if(document.getElementById("signup-start")||document.getElementById("signup-email-confirm")){SIGNUP.initStart()}if(document.getElementById("signup-cc")){SIGNUP.initCC()}if(document.getElementById("signup-dd")){SIGNUP.initDD();SIGNUP.PRINT.ddSetup()}MODALWINDOW.TERMS.init();if(top!==self){MODALWINDOW.ALREADYMEMBER.init()}MODALWINDOW.dialogSetup()});
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(c);if(!this.handle){return false}return true},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;(d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt));if(d.containment){this._setContainment()}if(this._trigger("start",c)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,c)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(c,true);return true},_mouseDrag:function(c,e){this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(this._trigger("drag",c,d)===false){this._mouseUp({});return false}this.position=d.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,c)}return false},_mouseStop:function(d){var e=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){e=a.ui.ddmanager.drop(this,d)}if(this.dropped){e=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original"){return false}if((this.options.revert=="invalid"&&!e)||(this.options.revert=="valid"&&e)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,e))){var c=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(c._trigger("stop",d)!==false){c._clear()}})}else{if(this._trigger("stop",d)!==false){this._clear()}}return false},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(c){var d=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==c.target){d=true}});return d},_createHelper:function(d){var e=this.options;var c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d])):(e.helper=="clone"?this.element.clone():this.element);if(!c.parents("body").length){c.appendTo((e.appendTo=="parent"?this.element[0].parentNode:e.appendTo))}if(c[0]!=this.element[0]&&!(/(fixed|absolute)/).test(c.css("position"))){c.css("position","absolute")}return c},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;if(f.containment=="parent"){f.containment=this.helper[0].parentNode}if(f.containment=="document"||f.containment=="window"){this.containment=[(f.containment=="document"?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(f.containment=="document"?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(f.containment=="document"?0:a(window).scrollLeft())+a(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(f.containment=="document"?0:a(window).scrollTop())+(a(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(f.containment)&&f.containment.constructor!=Array){var d=a(f.containment)[0];if(!d){return}var e=a(f.containment).offset();var c=(a(d).css("overflow")!="hidden");this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),e.left+(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,e.top+(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}else{if(f.containment.constructor==Array){this.containment=f.containment}}},_convertPositionTo:function(g,i){if(!i){i=this.position}var e=g=="absolute"?1:-1;var f=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(c[0].tagName);return{top:(i.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(h?0:c.scrollTop()))*e)),left:(i.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())*e))}},_generatePosition:function(f){var i=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(c[0].tagName);var e=f.pageX;var d=f.pageY;if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0]){e=this.containment[0]+this.offset.click.left}if(f.pageY-this.offset.click.top<this.containment[1]){d=this.containment[1]+this.offset.click.top}if(f.pageX-this.offset.click.left>this.containment[2]){e=this.containment[2]+this.offset.click.left}if(f.pageY-this.offset.click.top>this.containment[3]){d=this.containment[3]+this.offset.click.top}}if(i.grid){var h=this.originalPageY+Math.round((d-this.originalPageY)/i.grid[1])*i.grid[1];d=this.containment?(!(h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3])?h:(!(h-this.offset.click.top<this.containment[1])?h-i.grid[1]:h+i.grid[1])):h;var g=this.originalPageX+Math.round((e-this.originalPageX)/i.grid[0])*i.grid[0];e=this.containment?(!(g-this.offset.click.left<this.containment[0]||g-this.offset.click.left>this.containment[2])?g:(!(g-this.offset.click.left<this.containment[0])?g-i.grid[0]:g+i.grid[0])):g}}return{top:(d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:c.scrollTop())))),left:(e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:c.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(c,d,e){e=e||this._uiHash();a.ui.plugin.call(this,c,[d,e]);if(c=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,c,d,e)},plugins:{},_uiHash:function(c){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.11"});a.ui.plugin.add("draggable","connectToSortable",{start:function(d,f){var e=a(this).data("draggable"),g=e.options,c=a.extend({},f,{item:e.element});e.sortables=[];a(g.connectToSortable).each(function(){var h=a.data(this,"sortable");if(h&&!h.options.disabled){e.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",d,c)}})},stop:function(d,f){var e=a(this).data("draggable"),c=a.extend({},f,{item:e.element});a.each(e.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;e.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(d);this.instance.options.helper=this.instance.options._helper;if(e.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",d,c)}})},drag:function(d,g){var f=a(this).data("draggable"),c=this;var e=function(j){var p=this.offset.click.top,n=this.offset.click.left;var h=this.positionAbs.top,l=this.positionAbs.left;var k=j.height,m=j.width;var q=j.top,i=j.left;return a.ui.isOver(h+p,l+n,q,i,k,m)};a.each(f.sortables,function(h){this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(c).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return g.helper[0]};d.target=this.instance.currentItem[0];this.instance._mouseCapture(d,true);this.instance._mouseStart(d,true,true);this.instance.offset.click.top=f.offset.click.top;this.instance.offset.click.left=f.offset.click.left;this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top;f._trigger("toSortable",d);f.dropped=this.instance.element;f.currentItem=f.element;this.instance.fromOutside=f}if(this.instance.currentItem){this.instance._mouseDrag(d)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",d,this.instance._uiHash(this.instance));this.instance._mouseStop(d,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}f._trigger("fromSortable",d);f.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(d,e){var c=a("body"),f=a(this).data("draggable").options;if(c.css("cursor")){f._cursor=c.css("cursor")}c.css("cursor",f.cursor)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._cursor){a("body").css("cursor",e._cursor)}}});a.ui.plugin.add("draggable","iframeFix",{start:function(c,d){var e=a(this).data("draggable").options;a(e.iframeFix===true?"iframe":e.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})},stop:function(c,d){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("opacity")){f._opacity=c.css("opacity")}c.css("opacity",f.opacity)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._opacity){a(d.helper).css("opacity",e._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(d,e){var c=a(this).data("draggable");if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){c.overflowOffset=c.scrollParent.offset()}},drag:function(e,f){var d=a(this).data("draggable"),g=d.options,c=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!g.axis||g.axis!="x"){if((d.overflowOffset.top+d.scrollParent[0].offsetHeight)-e.pageY<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop+g.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop-g.scrollSpeed}}}if(!g.axis||g.axis!="y"){if((d.overflowOffset.left+d.scrollParent[0].offsetWidth)-e.pageX<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft+g.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft-g.scrollSpeed}}}}else{if(!g.axis||g.axis!="x"){if(e.pageY-a(document).scrollTop()<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)}}}if(!g.axis||g.axis!="y"){if(e.pageX-a(document).scrollLeft()<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed)}}}}if(c!==false&&a.ui.ddmanager&&!g.dropBehaviour){a.ui.ddmanager.prepareOffsets(d,e)}}});a.ui.plugin.add("draggable","snap",{start:function(d,e){var c=a(this).data("draggable"),f=c.options;c.snapElements=[];a(f.snap.constructor!=String?(f.snap.items||":data(draggable)"):f.snap).each(function(){var h=a(this);var g=h.offset();if(this!=c.element[0]){c.snapElements.push({item:this,width:h.outerWidth(),height:h.outerHeight(),top:g.top,left:g.left})}})},drag:function(u,p){var g=a(this).data("draggable"),q=g.options;var y=q.snapTolerance;var x=p.offset.left,w=x+g.helperProportions.width,f=p.offset.top,e=f+g.helperProportions.height;for(var v=g.snapElements.length-1;v>=0;v--){var s=g.snapElements[v].left,n=s+g.snapElements[v].width,m=g.snapElements[v].top,A=m+g.snapElements[v].height;if(!((s-y<x&&x<n+y&&m-y<f&&f<A+y)||(s-y<x&&x<n+y&&m-y<e&&e<A+y)||(s-y<w&&w<n+y&&m-y<f&&f<A+y)||(s-y<w&&w<n+y&&m-y<e&&e<A+y))){if(g.snapElements[v].snapping){(g.options.snap.release&&g.options.snap.release.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=false;continue}if(q.snapMode!="inner"){var c=Math.abs(m-e)<=y;var z=Math.abs(A-f)<=y;var j=Math.abs(s-w)<=y;var k=Math.abs(n-x)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m-g.helperProportions.height,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s-g.helperProportions.width}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n}).left-g.margins.left}}var h=(c||z||j||k);if(q.snapMode!="outer"){var c=Math.abs(m-f)<=y;var z=Math.abs(A-e)<=y;var j=Math.abs(s-x)<=y;var k=Math.abs(n-w)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A-g.helperProportions.height,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n-g.helperProportions.width}).left-g.margins.left}}if(!g.snapElements[v].snapping&&(c||z||j||k||h)){(g.options.snap.snap&&g.options.snap.snap.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=(c||z||j||k||h)}}});a.ui.plugin.add("draggable","stack",{start:function(d,e){var g=a(this).data("draggable").options;var f=a.makeArray(a(g.stack)).sort(function(i,h){return(parseInt(a(i).css("zIndex"),10)||0)-(parseInt(a(h).css("zIndex"),10)||0)});if(!f.length){return}var c=parseInt(f[0].style.zIndex)||0;a(f).each(function(h){this.style.zIndex=c+h});this[0].style.zIndex=c+f.length}});a.ui.plugin.add("draggable","zIndex",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("zIndex")){f._zIndex=c.css("zIndex")}c.css("zIndex",f.zIndex)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._zIndex){a(d.helper).css("zIndex",e._zIndex)}}})})(jQuery);
(function(c,d){c.widget("ui.resizable",c.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var f=this,k=this.options;this.element.addClass("ui-resizable");c.extend(this,{_aspectRatio:!!(k.aspectRatio),aspectRatio:k.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:k.helper||k.ghost||k.animate?k.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&c.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=k.handles||(!c(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var g=0;g<l.length;g++){var j=c.trim(l[g]),e="ui-resizable-"+j;var h=c('<div class="ui-resizable-handle '+e+'"></div>');if(/sw|se|ne|nw/.test(j)){h.css({zIndex:++k.zIndex})}if("se"==j){h.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[j]=".ui-resizable-"+j;this.element.append(h)}}this._renderAxis=function(q){q=q||this.element;for(var n in this.handles){if(this.handles[n].constructor==String){this.handles[n]=c(this.handles[n],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var o=c(this.handles[n],this.element),p=0;p=/sw|ne|nw|se|n|s/.test(n)?o.outerHeight():o.outerWidth();var m=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");q.css(m,p);this._proportionallyResize()}if(!c(this.handles[n]).length){continue}}};this._renderAxis(this.element);this._handles=c(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!f.resizing){if(this.className){var i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}f.axis=i&&i[1]?i[1]:"se"}});if(k.autoHide){this._handles.hide();c(this.element).addClass("ui-resizable-autohide").hover(function(){c(this).removeClass("ui-resizable-autohide");f._handles.show()},function(){if(!f.resizing){c(this).addClass("ui-resizable-autohide");f._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;f.after(this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);e(this.originalElement);return this},_mouseCapture:function(f){var g=false;for(var e in this.handles){if(c(this.handles[e])[0]==f.target){g=true}}return !this.options.disabled&&g},_mouseStart:function(g){var j=this.options,f=this.element.position(),e=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(e.is(".ui-draggable")||(/absolute/).test(e.css("position"))){e.css({position:"absolute",top:f.top,left:f.left})}if(c.browser.opera&&(/relative/).test(e.css("position"))){e.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var k=b(this.helper.css("left")),h=b(this.helper.css("top"));if(j.containment){k+=c(j.containment).scrollLeft()||0;h+=c(j.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:k,top:h};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:k,top:h};this.sizeDiff={width:e.outerWidth()-e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:g.pageX,top:g.pageY};this.aspectRatio=(typeof j.aspectRatio=="number")?j.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var i=c(".ui-resizable-"+this.axis).css("cursor");c("body").css("cursor",i=="auto"?this.axis+"-resize":i);e.addClass("ui-resizable-resizing");this._propagate("start",g);return true},_mouseDrag:function(e){var h=this.helper,g=this.options,m={},q=this,j=this.originalMousePosition,n=this.axis;var r=(e.pageX-j.left)||0,p=(e.pageY-j.top)||0;var i=this._change[n];if(!i){return false}var l=i.apply(this,[e,r,p]),k=c.browser.msie&&c.browser.version<7,f=this.sizeDiff;if(this._aspectRatio||e.shiftKey){l=this._updateRatio(l,e)}l=this._respectSize(l,e);this._propagate("resize",e);h.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(l);this._trigger("resize",e,this.ui());return false},_mouseStop:function(h){this.resizing=false;var i=this.options,m=this;if(this._helper){var g=this._proportionallyResizeElements,e=g.length&&(/textarea/i).test(g[0].nodeName),f=e&&c.ui.hasScroll(g[0],"left")?0:m.sizeDiff.height,k=e?0:m.sizeDiff.width;var n={width:(m.helper.width()-k),height:(m.helper.height()-f)},j=(parseInt(m.element.css("left"),10)+(m.position.left-m.originalPosition.left))||null,l=(parseInt(m.element.css("top"),10)+(m.position.top-m.originalPosition.top))||null;if(!i.animate){this.element.css(c.extend(n,{top:l,left:j}))}m.helper.height(m.size.height);m.helper.width(m.size.width);if(this._helper&&!i.animate){this._proportionallyResize()}}c("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",h);if(this._helper){this.helper.remove()}return false},_updateCache:function(e){var f=this.options;this.offset=this.helper.offset();if(a(e.left)){this.position.left=e.left}if(a(e.top)){this.position.top=e.top}if(a(e.height)){this.size.height=e.height}if(a(e.width)){this.size.width=e.width}},_updateRatio:function(h,g){var i=this.options,j=this.position,f=this.size,e=this.axis;if(h.height){h.width=(f.height*this.aspectRatio)}else{if(h.width){h.height=(f.width/this.aspectRatio)}}if(e=="sw"){h.left=j.left+(f.width-h.width);h.top=null}if(e=="nw"){h.top=j.top+(f.height-h.height);h.left=j.left+(f.width-h.width)}return h},_respectSize:function(l,g){var j=this.helper,i=this.options,r=this._aspectRatio||g.shiftKey,q=this.axis,t=a(l.width)&&i.maxWidth&&(i.maxWidth<l.width),m=a(l.height)&&i.maxHeight&&(i.maxHeight<l.height),h=a(l.width)&&i.minWidth&&(i.minWidth>l.width),s=a(l.height)&&i.minHeight&&(i.minHeight>l.height);if(h){l.width=i.minWidth}if(s){l.height=i.minHeight}if(t){l.width=i.maxWidth}if(m){l.height=i.maxHeight}var f=this.originalPosition.left+this.originalSize.width,p=this.position.top+this.size.height;var k=/sw|nw|w/.test(q),e=/nw|ne|n/.test(q);if(h&&k){l.left=f-i.minWidth}if(t&&k){l.left=f-i.maxWidth}if(s&&e){l.top=p-i.minHeight}if(m&&e){l.top=p-i.maxHeight}var n=!l.width&&!l.height;if(n&&!l.left&&l.top){l.top=null}else{if(n&&!l.top&&l.left){l.left=null}}return l},_proportionallyResize:function(){var k=this.options;if(!this._proportionallyResizeElements.length){return}var g=this.helper||this.element;for(var f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var e=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],j=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=c.map(e,function(l,n){var m=parseInt(l,10)||0,o=parseInt(j[n],10)||0;return m+o})}if(c.browser.msie&&!(!(c(g).is(":hidden")||c(g).parents(":hidden").length))){continue}h.css({height:(g.height()-this.borderDif[0]-this.borderDif[2])||0,width:(g.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var f=this.element,i=this.options;this.elementOffset=f.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var e=c.browser.msie&&c.browser.version<7,g=(e?1:0),h=(e?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+h,height:this.element.outerHeight()+h,position:"absolute",left:this.elementOffset.left-g+"px",top:this.elementOffset.top-g+"px",zIndex:++i.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,e){return{width:this.originalSize.width+f}},w:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{left:i.left+f,width:g.width-f}},n:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{top:i.top+e,height:g.height-e}},s:function(g,f,e){return{height:this.originalSize.height+e}},se:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},sw:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[g,f,e]))},ne:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},nw:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[g,f,e]))}},_propagate:function(f,e){c.ui.plugin.call(this,f,[e,this.ui()]);(f!="resize"&&this._trigger(f,e,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.extend(c.ui.resizable,{version:"1.8.11"});c.ui.plugin.add("resizable","alsoResize",{start:function(f,g){var e=c(this).data("resizable"),i=e.options;var h=function(j){c(j).each(function(){var k=c(this);k.data("resizable-alsoresize",{width:parseInt(k.width(),10),height:parseInt(k.height(),10),left:parseInt(k.css("left"),10),top:parseInt(k.css("top"),10),position:k.css("position")})})};if(typeof(i.alsoResize)=="object"&&!i.alsoResize.parentNode){if(i.alsoResize.length){i.alsoResize=i.alsoResize[0];h(i.alsoResize)}else{c.each(i.alsoResize,function(j){h(j)})}}else{h(i.alsoResize)}},resize:function(g,i){var f=c(this).data("resizable"),j=f.options,h=f.originalSize,l=f.originalPosition;var k={height:(f.size.height-h.height)||0,width:(f.size.width-h.width)||0,top:(f.position.top-l.top)||0,left:(f.position.left-l.left)||0},e=function(m,n){c(m).each(function(){var q=c(this),r=c(this).data("resizable-alsoresize"),p={},o=n&&n.length?n:q.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(o,function(s,u){var t=(r[u]||0)+(k[u]||0);if(t&&t>=0){p[u]=t||null}});if(c.browser.opera&&/relative/.test(q.css("position"))){f._revertToRelativePosition=true;q.css({position:"absolute",top:"auto",left:"auto"})}q.css(p)})};if(typeof(j.alsoResize)=="object"&&!j.alsoResize.nodeType){c.each(j.alsoResize,function(m,n){e(m,n)})}else{e(j.alsoResize)}},stop:function(g,h){var f=c(this).data("resizable"),i=f.options;var e=function(j){c(j).each(function(){var k=c(this);k.css({position:k.data("resizable-alsoresize").position})})};if(f._revertToRelativePosition){f._revertToRelativePosition=false;if(typeof(i.alsoResize)=="object"&&!i.alsoResize.nodeType){c.each(i.alsoResize,function(j){e(j)})}else{e(i.alsoResize)}}c(this).removeData("resizable-alsoresize")}});c.ui.plugin.add("resizable","animate",{stop:function(i,n){var p=c(this).data("resizable"),j=p.options;var h=p._proportionallyResizeElements,e=h.length&&(/textarea/i).test(h[0].nodeName),f=e&&c.ui.hasScroll(h[0],"left")?0:p.sizeDiff.height,l=e?0:p.sizeDiff.width;var g={width:(p.size.width-l),height:(p.size.height-f)},k=(parseInt(p.element.css("left"),10)+(p.position.left-p.originalPosition.left))||null,m=(parseInt(p.element.css("top"),10)+(p.position.top-p.originalPosition.top))||null;p.element.animate(c.extend(g,m&&k?{top:m,left:k}:{}),{duration:j.animateDuration,easing:j.animateEasing,step:function(){var o={width:parseInt(p.element.css("width"),10),height:parseInt(p.element.css("height"),10),top:parseInt(p.element.css("top"),10),left:parseInt(p.element.css("left"),10)};if(h&&h.length){c(h[0]).css({width:o.width,height:o.height})}p._updateCache(o);p._propagate("resize",i)}})}});c.ui.plugin.add("resizable","containment",{start:function(f,r){var t=c(this).data("resizable"),j=t.options,l=t.element;var g=j.containment,k=(g instanceof c)?g.get(0):(/parent/.test(g))?l.parent().get(0):g;if(!k){return}t.containerElement=c(k);if(/document/.test(g)||g==document){t.containerOffset={left:0,top:0};t.containerPosition={left:0,top:0};t.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var n=c(k),i=[];c(["Top","Right","Left","Bottom"]).each(function(p,o){i[p]=b(n.css("padding"+o))});t.containerOffset=n.offset();t.containerPosition=n.position();t.containerSize={height:(n.innerHeight()-i[3]),width:(n.innerWidth()-i[1])};var q=t.containerOffset,e=t.containerSize.height,m=t.containerSize.width,h=(c.ui.hasScroll(k,"left")?k.scrollWidth:m),s=(c.ui.hasScroll(k)?k.scrollHeight:e);t.parentData={element:k,left:q.left,top:q.top,width:h,height:s}}},resize:function(g,q){var t=c(this).data("resizable"),i=t.options,f=t.containerSize,p=t.containerOffset,m=t.size,n=t.position,r=t._aspectRatio||g.shiftKey,e={top:0,left:0},h=t.containerElement;if(h[0]!=document&&(/static/).test(h.css("position"))){e=p}if(n.left<(t._helper?p.left:0)){t.size.width=t.size.width+(t._helper?(t.position.left-p.left):(t.position.left-e.left));if(r){t.size.height=t.size.width/i.aspectRatio}t.position.left=i.helper?p.left:0}if(n.top<(t._helper?p.top:0)){t.size.height=t.size.height+(t._helper?(t.position.top-p.top):t.position.top);if(r){t.size.width=t.size.height*i.aspectRatio}t.position.top=t._helper?p.top:0}t.offset.left=t.parentData.left+t.position.left;t.offset.top=t.parentData.top+t.position.top;var l=Math.abs((t._helper?t.offset.left-e.left:(t.offset.left-e.left))+t.sizeDiff.width),s=Math.abs((t._helper?t.offset.top-e.top:(t.offset.top-p.top))+t.sizeDiff.height);var k=t.containerElement.get(0)==t.element.parent().get(0),j=/relative|absolute/.test(t.containerElement.css("position"));if(k&&j){l-=t.parentData.left}if(l+t.size.width>=t.parentData.width){t.size.width=t.parentData.width-l;if(r){t.size.height=t.size.width/t.aspectRatio}}if(s+t.size.height>=t.parentData.height){t.size.height=t.parentData.height-s;if(r){t.size.width=t.size.height*t.aspectRatio}}},stop:function(f,n){var q=c(this).data("resizable"),g=q.options,l=q.position,m=q.containerOffset,e=q.containerPosition,i=q.containerElement;var j=c(q.helper),r=j.offset(),p=j.outerWidth()-q.sizeDiff.width,k=j.outerHeight()-q.sizeDiff.height;if(q._helper&&!g.animate&&(/relative/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}if(q._helper&&!g.animate&&(/static/).test(i.css("position"))){c(this).css({left:r.left-e.left-m.left,width:p,height:k})}}});c.ui.plugin.add("resizable","ghost",{start:function(g,h){var e=c(this).data("resizable"),i=e.options,f=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:"");e.ghost.appendTo(e.helper)},resize:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});c.ui.plugin.add("resizable","grid",{resize:function(e,m){var p=c(this).data("resizable"),h=p.options,k=p.size,i=p.originalSize,j=p.originalPosition,n=p.axis,l=h._aspectRatio||e.shiftKey;h.grid=typeof h.grid=="number"?[h.grid,h.grid]:h.grid;var g=Math.round((k.width-i.width)/(h.grid[0]||1))*(h.grid[0]||1),f=Math.round((k.height-i.height)/(h.grid[1]||1))*(h.grid[1]||1);if(/^(se|s|e)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f}else{if(/^(ne)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f;p.position.top=j.top-f}else{if(/^(sw)$/.test(n)){p.size.width=i.width+g;p.size.height=i.height+f;p.position.left=j.left-g}else{p.size.width=i.width+g;p.size.height=i.height+f;p.position.top=j.top-f;p.position.left=j.left-g}}}}});var b=function(e){return parseInt(e,10)||0};var a=function(e){return !isNaN(parseInt(e,10))}})(jQuery);
(function(d,e){var b="ui-dialog ui-widget ui-widget-content ui-corner-all ",a={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},c={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};d.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(g){var f=d(this).css(g).offset().top;if(f<0){d(this).css("top",g.top-f)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var n=this,o=n.options,l=o.title||"&#160;",g=d.ui.dialog.getTitleId(n.element),m=(n.uiDialog=d("<div></div>")).appendTo(document.body).hide().addClass(b+o.dialogClass).css({zIndex:o.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(p){if(o.closeOnEscape&&p.keyCode&&p.keyCode===d.ui.keyCode.ESCAPE){n.close(p);p.preventDefault()}}).attr({role:"dialog","aria-labelledby":g}).mousedown(function(p){n.moveToTop(false,p)}),i=n.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(m),h=(n.uiDialogTitlebar=d("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(m),k=d('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){k.addClass("ui-state-hover")},function(){k.removeClass("ui-state-hover")}).focus(function(){k.addClass("ui-state-focus")}).blur(function(){k.removeClass("ui-state-focus")}).click(function(p){n.close(p);return false}).appendTo(h),j=(n.uiDialogTitlebarCloseText=d("<span></span>")).addClass("ui-icon ui-icon-closethick").text(o.closeText).appendTo(k),f=d("<span></span>").addClass("ui-dialog-title").attr("id",g).html(l).prependTo(h);if(d.isFunction(o.beforeclose)&&!d.isFunction(o.beforeClose)){o.beforeClose=o.beforeclose}h.find("*").add(h).disableSelection();if(o.draggable&&d.fn.draggable){n._makeDraggable()}if(o.resizable&&d.fn.resizable){n._makeResizable()}n._createButtons(o.buttons);n._isOpen=false;if(d.fn.bgiframe){m.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},destroy:function(){var f=this;if(f.overlay){f.overlay.destroy()}f.uiDialog.hide();f.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");f.uiDialog.remove();if(f.originalTitle){f.element.attr("title",f.originalTitle)}return f},widget:function(){return this.uiDialog},close:function(i){var f=this,h,g;if(false===f._trigger("beforeClose",i)){return}if(f.overlay){f.overlay.destroy()}f.uiDialog.unbind("keypress.ui-dialog");f._isOpen=false;if(f.options.hide){f.uiDialog.hide(f.options.hide,function(){f._trigger("close",i)})}else{f.uiDialog.hide();f._trigger("close",i)}d.ui.dialog.overlay.resize();if(f.options.modal){h=0;d(".ui-dialog").each(function(){if(this!==f.uiDialog[0]){g=d(this).css("z-index");if(!isNaN(g)){h=Math.max(h,g)}}});d.ui.dialog.maxZ=h}return f},isOpen:function(){return this._isOpen},moveToTop:function(j,i){var f=this,h=f.options,g;if((h.modal&&!j)||(!h.stack&&!h.modal)){return f._trigger("focus",i)}if(h.zIndex>d.ui.dialog.maxZ){d.ui.dialog.maxZ=h.zIndex}if(f.overlay){d.ui.dialog.maxZ+=1;f.overlay.$el.css("z-index",d.ui.dialog.overlay.maxZ=d.ui.dialog.maxZ)}g={scrollTop:f.element.attr("scrollTop"),scrollLeft:f.element.attr("scrollLeft")};d.ui.dialog.maxZ+=1;f.uiDialog.css("z-index",d.ui.dialog.maxZ);f.element.attr(g);f._trigger("focus",i);return f},open:function(){if(this._isOpen){return}var g=this,h=g.options,f=g.uiDialog;g.overlay=h.modal?new d.ui.dialog.overlay(g):null;g._size();g._position(h.position);f.show(h.show);g.moveToTop(true);if(h.modal){f.bind("keypress.ui-dialog",function(k){if(k.keyCode!==d.ui.keyCode.TAB){return}var j=d(":tabbable",this),l=j.filter(":first"),i=j.filter(":last");if(k.target===i[0]&&!k.shiftKey){l.focus(1);return false}else{if(k.target===l[0]&&k.shiftKey){i.focus(1);return false}}})}d(g.element.find(":tabbable").get().concat(f.find(".ui-dialog-buttonpane :tabbable").get().concat(f.get()))).eq(0).focus();g._isOpen=true;g._trigger("open");return g},_createButtons:function(i){var h=this,f=false,g=d("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),j=d("<div></div>").addClass("ui-dialog-buttonset").appendTo(g);h.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof i==="object"&&i!==null){d.each(i,function(){return !(f=true)})}if(f){d.each(i,function(k,m){m=d.isFunction(m)?{click:m,text:k}:m;var l=d('<button type="button"></button>').attr(m,true).unbind("click").click(function(){m.click.apply(h.element[0],arguments)}).appendTo(j);if(d.fn.button){l.button()}});g.appendTo(h.uiDialog)}},_makeDraggable:function(){var f=this,i=f.options,j=d(document),h;function g(k){return{position:k.position,offset:k.offset}}f.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(k,l){h=i.height==="auto"?"auto":d(this).height();d(this).height(d(this).height()).addClass("ui-dialog-dragging");f._trigger("dragStart",k,g(l))},drag:function(k,l){f._trigger("drag",k,g(l))},stop:function(k,l){i.position=[l.position.left-j.scrollLeft(),l.position.top-j.scrollTop()];d(this).removeClass("ui-dialog-dragging").height(h);f._trigger("dragStop",k,g(l));d.ui.dialog.overlay.resize()}})},_makeResizable:function(k){k=(k===e?this.options.resizable:k);var g=this,j=g.options,f=g.uiDialog.css("position"),i=(typeof k==="string"?k:"n,e,s,w,se,sw,ne,nw");function h(l){return{originalPosition:l.originalPosition,originalSize:l.originalSize,position:l.position,size:l.size}}g.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:g.element,maxWidth:j.maxWidth,maxHeight:j.maxHeight,minWidth:j.minWidth,minHeight:g._minHeight(),handles:i,start:function(l,m){d(this).addClass("ui-dialog-resizing");g._trigger("resizeStart",l,h(m))},resize:function(l,m){g._trigger("resize",l,h(m))},stop:function(l,m){d(this).removeClass("ui-dialog-resizing");j.height=d(this).height();j.width=d(this).width();g._trigger("resizeStop",l,h(m));d.ui.dialog.overlay.resize()}}).css("position",f).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var f=this.options;if(f.height==="auto"){return f.minHeight}else{return Math.min(f.minHeight,f.height)}},_position:function(g){var h=[],i=[0,0],f;if(g){if(typeof g==="string"||(typeof g==="object"&&"0" in g)){h=g.split?g.split(" "):[g[0],g[1]];if(h.length===1){h[1]=h[0]}d.each(["left","top"],function(k,j){if(+h[k]===h[k]){i[k]=h[k];h[k]=j}});g={my:h.join(" "),at:h.join(" "),offset:i.join(" ")}}g=d.extend({},d.ui.dialog.prototype.options.position,g)}else{g=d.ui.dialog.prototype.options.position}f=this.uiDialog.is(":visible");if(!f){this.uiDialog.show()}this.uiDialog.css({top:0,left:0}).position(d.extend({of:window},g));if(!f){this.uiDialog.hide()}},_setOptions:function(i){var g=this,f={},h=false;d.each(i,function(j,k){g._setOption(j,k);if(j in a){h=true}if(j in c){f[j]=k}});if(h){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",f)}},_setOption:function(i,j){var g=this,f=g.uiDialog;switch(i){case"beforeclose":i="beforeClose";break;case"buttons":g._createButtons(j);break;case"closeText":g.uiDialogTitlebarCloseText.text(""+j);break;case"dialogClass":f.removeClass(g.options.dialogClass).addClass(b+j);break;case"disabled":if(j){f.addClass("ui-dialog-disabled")}else{f.removeClass("ui-dialog-disabled")}break;case"draggable":var h=f.is(":data(draggable)");if(h&&!j){f.draggable("destroy")}if(!h&&j){g._makeDraggable()}break;case"position":g._position(j);break;case"resizable":var k=f.is(":data(resizable)");if(k&&!j){f.resizable("destroy")}if(k&&typeof j==="string"){f.resizable("option","handles",j)}if(!k&&j!==false){g._makeResizable(j)}break;case"title":d(".ui-dialog-title",g.uiDialogTitlebar).html(""+(j||"&#160;"));break}d.Widget.prototype._setOption.apply(g,arguments)},_size:function(){var j=this.options,g,i,f=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(j.minWidth>j.width){j.width=j.minWidth}g=this.uiDialog.css({height:"auto",width:j.width}).height();i=Math.max(0,j.minHeight-g);if(j.height==="auto"){if(d.support.minHeight){this.element.css({minHeight:i,height:"auto"})}else{this.uiDialog.show();var h=this.element.css("height","auto").height();if(!f){this.uiDialog.hide()}this.element.height(Math.max(h,i))}}else{this.element.height(Math.max(j.height-g,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});d.extend(d.ui.dialog,{version:"1.8.11",uuid:0,maxZ:0,getTitleId:function(f){var g=f.attr("id");if(!g){this.uuid+=1;g=this.uuid}return"ui-dialog-title-"+g},overlay:function(f){this.$el=d.ui.dialog.overlay.create(f)}});d.extend(d.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:d.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(f){return f+".dialog-overlay"}).join(" "),create:function(g){if(this.instances.length===0){setTimeout(function(){if(d.ui.dialog.overlay.instances.length){d(document).bind(d.ui.dialog.overlay.events,function(h){if(d(h.target).zIndex()<d.ui.dialog.overlay.maxZ){return false}})}},1);d(document).bind("keydown.dialog-overlay",function(h){if(g.options.closeOnEscape&&h.keyCode&&h.keyCode===d.ui.keyCode.ESCAPE){g.close(h);h.preventDefault()}});d(window).bind("resize.dialog-overlay",d.ui.dialog.overlay.resize)}var f=(this.oldInstances.pop()||d("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if(d.fn.bgiframe){f.bgiframe()}this.instances.push(f);return f},destroy:function(f){var g=d.inArray(f,this.instances);if(g!=-1){this.oldInstances.push(this.instances.splice(g,1)[0])}if(this.instances.length===0){d([document,window]).unbind(".dialog-overlay")}f.remove();var h=0;d.each(this.instances,function(){h=Math.max(h,this.css("z-index"))});this.maxZ=h},height:function(){var g,f;if(d.browser.msie&&d.browser.version<7){g=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);f=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(g<f){return d(window).height()+"px"}else{return g+"px"}}else{return d(document).height()+"px"}},width:function(){var f,g;if(d.browser.msie&&d.browser.version<7){f=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);g=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(f<g){return d(window).width()+"px"}else{return f+"px"}}else{return d(document).width()+"px"}},resize:function(){var f=d([]);d.each(d.ui.dialog.overlay.instances,function(){f=f.add(this)});f.css({width:0,height:0}).css({width:d.ui.dialog.overlay.width(),height:d.ui.dialog.overlay.height()})}});d.extend(d.ui.dialog.overlay.prototype,{destroy:function(){d.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));
/*
 HTML5 Shiv v3.7.0 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed
*/
(function(l,f){function m(){var a=e.elements;return"string"==typeof a?a.split(" "):a}function i(a){var b=n[a[o]];b||(b={},h++,a[o]=h,n[h]=b);return b}function p(a,b,c){b||(b=f);if(g)return b.createElement(a);c||(c=i(b));b=c.cache[a]?c.cache[a].cloneNode():r.test(a)?(c.cache[a]=c.createElem(a)).cloneNode():c.createElem(a);return b.canHaveChildren&&!s.test(a)?c.frag.appendChild(b):b}function t(a,b){if(!b.cache)b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag();
a.createElement=function(c){return!e.shivMethods?b.createElem(c):p(c,a,b)};a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+m().join().replace(/[\w\-]+/g,function(a){b.createElem(a);b.frag.createElement(a);return'c("'+a+'")'})+");return n}")(e,b.frag)}function q(a){a||(a=f);var b=i(a);if(e.shivCSS&&!j&&!b.hasCSS){var c,d=a;c=d.createElement("p");d=d.getElementsByTagName("head")[0]||d.documentElement;c.innerHTML="x<style>article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}</style>";
c=d.insertBefore(c.lastChild,d.firstChild);b.hasCSS=!!c}g||t(a,b);return a}var k=l.html5||{},s=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,r=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,j,o="_html5shiv",h=0,n={},g;(function(){try{var a=f.createElement("a");a.innerHTML="<xyz></xyz>";j="hidden"in a;var b;if(!(b=1==a.childNodes.length)){f.createElement("a");var c=f.createDocumentFragment();b="undefined"==typeof c.cloneNode||
"undefined"==typeof c.createDocumentFragment||"undefined"==typeof c.createElement}g=b}catch(d){g=j=!0}})();var e={elements:k.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==k.shivCSS,supportsUnknownElements:g,shivMethods:!1!==k.shivMethods,type:"default",shivDocument:q,createElement:p,createDocumentFragment:function(a,b){a||(a=f);
if(g)return a.createDocumentFragment();for(var b=b||i(a),c=b.frag.cloneNode(),d=0,e=m(),h=e.length;d<h;d++)c.createElement(e[d]);return c}};l.html5=e;q(f)})(this,document);

/*! H5F
* https://github.com/ryanseddon/H5F/
* Copyright (c) Ryan Seddon | Licensed MIT */

(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(factory);
    } else {
        // Browser globals
        root.H5F = factory();
    }
}(this, function () {

    var d = document,
        field = d.createElement("input"),
        emailPatt = /^[a-zA-Z0-9.!#$%&'*+-\/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,
        urlPatt = /[a-z][\-\.+a-z]*:\/\//i,
        nodes = /^(input|select|textarea)$/i,
        isSubmit, bypassSubmit, usrPatt, curEvt, args,
        // Methods
        setup, validation, validity, checkField, bypassChecks, checkValidity, setCustomValidity, support, pattern, placeholder, range, required, valueMissing, listen, unlisten, preventActions, getTarget, addClass, removeClass, isHostMethod, isSiblingChecked;
    
    setup = function(form, settings) {
        var isCollection = !form.nodeType || false;
        
        var opts = {
            validEvent : function(el) {
                removeClass(el,['invalid', 'required']);
                addClass(el, 'valid');
            },
            invalidEvent : function(el) {
                removeClass(el,['valid', 'required']);
                addClass(el, 'invalid');
            },
            requiredEvent : function(el) {
                removeClass(el,['invalid', 'valid']);
                addClass(el, 'required');
            },
            placeholderClass : "placeholder"
        };

        if(typeof settings === "object") {
            for (var i in opts) {
                if(typeof settings[i] === "undefined") { settings[i] = opts[i]; }
            }
        }
        
        args = settings || opts;
        
        if(isCollection) {
            for(var k=0,len=form.length;k<len;k++) {
                validation(form[k]);
            }
        } else {
            validation(form);
        }
    };
    
    validation = function(form) {
        var f = form.elements,
            flen = f.length,
            isRequired,
            noValidate = !!(form.attributes["novalidate"]);
        
        listen(form,"invalid",checkField,true);
        listen(form,"blur",checkField,true);
        listen(form,"input",checkField,true);
        listen(form,"keyup",checkField,true);
        listen(form,"focus",checkField,true);
        listen(form,"change",checkField,true);
        listen(form,"click",bypassChecks,true);
        
        listen(form,"submit",function(e){
            isSubmit = true;
            if(!bypassSubmit) {
                if(!noValidate && !form.checkValidity()) {
                    preventActions(e);
                }
            }
        },false);
        
        if(!support()) {
            form.checkValidity = function() { return checkValidity(form); };
            
            while(flen--) {
                isRequired = !!(f[flen].attributes["required"]);
                // Firefox includes fieldsets inside elements nodelist so we filter it out.
                if(f[flen].nodeName.toLowerCase() !== "fieldset") {
                    validity(f[flen]); // Add validity object to field
                }
            }
        }
    };
    validity = function(el) {
        var elem = el,
            missing = valueMissing(elem),
            attrs = {
                type: elem.getAttribute("type"),
                pattern: elem.getAttribute("pattern"),
                placeholder: elem.getAttribute("placeholder")
            },
            isType = /^(email|url)$/i,
            evt = /^(input|keyup)$/i,
            fType = ((isType.test(attrs.type)) ? attrs.type : ((attrs.pattern) ? attrs.pattern : false)),
            patt = pattern(elem,fType),
            step = range(elem,"step"),
            min = range(elem,"min"),
            max = range(elem,"max"),
            customError = !( elem.validationMessage === "" || elem.validationMessage === undefined );
        
        elem.checkValidity = function() { return checkValidity.call(this,elem); };
        elem.setCustomValidity = function(msg) { setCustomValidity.call(elem,msg); };
        
        elem.validity = {
            valueMissing: missing,
            patternMismatch: patt,
            rangeUnderflow: min,
            rangeOverflow: max,
            stepMismatch: step,
            customError: customError,
            valid: (!missing && !patt && !step && !min && !max && !customError)
        };
        
        if(attrs.placeholder && !evt.test(curEvt)) { placeholder(elem); }
    };
    checkField = function(e) {
        var el = getTarget(e) || e, // checkValidity method passes element not event
            events = /^(input|keyup|focusin|focus|change)$/i,
            ignoredTypes = /^(submit|image|button|reset)$/i,
            specialTypes = /^(checkbox|radio)$/i,
            checkForm = true;
        
        if(nodes.test(el.nodeName) && !(ignoredTypes.test(el.type) || ignoredTypes.test(el.nodeName))) {
            curEvt = e.type;

            if(!support()) {
                validity(el);
            }

            if(el.validity.valid && (el.value !== "" || specialTypes.test(el.type)) || (el.value !== el.getAttribute("placeholder") && el.validity.valid)) {
                args.validEvent(el);
            } else if(!events.test(curEvt)) {
                if(el.validity.valueMissing) {
                    args.requiredEvent(el);
                } else if(!el.validity.valid) {
                    args.invalidEvent(el);
                }
            } else if(el.validity.valueMissing) {
                // TODO: Do we need a "reset" event?
                removeClass(el,[args.requiredClass,args.invalidClass,args.validClass]);
            }
            if(curEvt === "input" && checkForm) {
                // If input is triggered remove the keyup event
                unlisten(el.form,"keyup",checkField,true);
                checkForm = false;
            }
        }
    };
    checkValidity = function(el) {
        var f, ff, isRequired, hasPattern, invalid = false;
        
        if(el.nodeName.toLowerCase() === "form") {
            f = el.elements;
            
            for(var i = 0,len = f.length;i < len;i++) {
                ff = f[i];
                
                isRequired = !!(ff.attributes["required"]);
                hasPattern = !!(ff.attributes["pattern"]);
                
                if(ff.nodeName.toLowerCase() !== "fieldset" && (isRequired || hasPattern && isRequired)) {
                    checkField(ff);
                    if(!ff.validity.valid && !invalid) {
                        if(isSubmit) { // If it's not a submit event the field shouldn't be focused
                            ff.focus();
                        }
                        invalid = true;
                    }
                }
            }
            return !invalid;
        } else {
            checkField(el);
            return el.validity.valid;
        }
    };
    setCustomValidity = function(msg) {
        var el = this;
            
        el.validationMessage = msg;
    };
    
    bypassChecks = function(e) {
        // handle formnovalidate attribute
        var el = getTarget(e);

        if(el.attributes["formnovalidate"] && el.type === "submit") {
            bypassSubmit = true;
        }
    };

    support = function() {
        return (isHostMethod(field,"validity") && isHostMethod(field,"checkValidity"));
    };

    // Create helper methods to emulate attributes in older browsers
    pattern = function(el, type) {
        if(type === "email") {
            return !emailPatt.test(el.value);
        } else if(type === "url") {
            return !urlPatt.test(el.value);
        } else if(!type) {
            return false;
        } else {
            var placeholder = el.getAttribute("placeholder"),
                val = el.value;
            
            usrPatt = new RegExp('^(?:' + type + ')$');
            
            if(val === placeholder) {
                return false;
            } else if(val === "") {
                return false;
            } else {
                return !usrPatt.test(el.value);
            }
        }
    };
    placeholder = function(el) {
        var attrs = { placeholder: el.getAttribute("placeholder") },
            focus = /^(focus|focusin|submit)$/i,
            node = /^(input|textarea)$/i,
            ignoredType = /^password$/i,
            isNative = !!("placeholder" in field);
        
        if(!isNative && node.test(el.nodeName) && !ignoredType.test(el.type)) {
            if(el.value === "" && !focus.test(curEvt)) {
                el.value = attrs.placeholder;
                listen(el.form,'submit', function () {
                  curEvt = 'submit';
                  placeholder(el);
                }, true);
                addClass(el,args.placeholderClass);
            } else if(el.value === attrs.placeholder && focus.test(curEvt)) {
                el.value = "";
                removeClass(el,args.placeholderClass);
            }
        }
    };
    range = function(el, type) {
        // Emulate min, max and step
        var min = parseInt(el.getAttribute("min"),10) || 0,
            max = parseInt(el.getAttribute("max"),10) || false,
            step = parseInt(el.getAttribute("step"),10) || 1,
            val = parseInt(el.value,10),
            mismatch = (val-min)%step;
        
        if(!valueMissing(el) && !isNaN(val)) {
            if(type === "step") {
                return (el.getAttribute("step")) ? (mismatch !== 0) : false;
            } else if(type === "min") {
                return (el.getAttribute("min")) ? (val < min) : false;
            } else if(type === "max") {
                return (el.getAttribute("max")) ? (val > max) : false;
            }
        } else if(el.getAttribute("type") === "number") {
            return true;
        } else {
            return false;
        }
    };
    required = function(el) {
        var required = !!(el.attributes["required"]);
        
        return (required) ? valueMissing(el) : false;
    };
    valueMissing = function(el) {
        var placeholder = el.getAttribute("placeholder"),
            specialTypes = /^(checkbox|radio)$/i,
            isRequired = !!(el.attributes["required"]);
        return !!(isRequired && (el.value === "" || el.value === placeholder || (specialTypes.test(el.type) && !isSiblingChecked(el))));
    };
    
    /* Util methods */
    listen = function (node,type,fn,capture) {
        if(isHostMethod(window,"addEventListener")) {
            /* FF & Other Browsers */
            node.addEventListener( type, fn, capture );
        } else if(isHostMethod(window,"attachEvent") && typeof window.event !== "undefined") {
            /* Internet Explorer way */
            if(type === "blur") {
                type = "focusout";
            } else if(type === "focus") {
                type = "focusin";
            }
            node.attachEvent( "on" + type, fn );
        }
    };
    unlisten = function (node,type,fn,capture) {
        if(isHostMethod(window,"removeEventListener")) {
            /* FF & Other Browsers */
            node.removeEventListener( type, fn, capture );
        } else if(isHostMethod(window,"detachEvent") && typeof window.event !== "undefined") {
            /* Internet Explorer way */
            node.detachEvent( "on" + type, fn );
        }
    };
    preventActions = function (evt) {
        evt = evt || window.event;
        
        if(evt.stopPropagation && evt.preventDefault) {
            evt.stopPropagation();
            evt.preventDefault();
        } else {
            evt.cancelBubble = true;
            evt.returnValue = false;
        }
    };
    getTarget = function (evt) {
        evt = evt || window.event;
        return evt.target || evt.srcElement;
    };
    addClass = function (e,c) {
        var re;
        if (!e.className) {
            e.className = c;
        }
        else {
            re = new RegExp('(^|\\s)' + c + '(\\s|$)');
            if (!re.test(e.className)) { e.className += ' ' + c; }
        }
    };
    removeClass = function (e,c) {
        var re, m, arr = (typeof c === "object") ? c.length : 1, len = arr;
        if (e.className) {
            if (e.className === c) {
                e.className = '';
            } else {
                while(arr--) {
                    re = new RegExp('(^|\\s)' + ((len > 1) ? c[arr] : c) + '(\\s|$)');
                    m = e.className.match(re);
                    if (m && m.length === 3) { e.className = e.className.replace(re, (m[1] && m[2])?' ':''); }
                }
            }
        }
    };
    isHostMethod = function(o, m) {
        var t = typeof o[m], reFeaturedMethod = new RegExp('^function|object$', 'i');
        return !!((reFeaturedMethod.test(t) && o[m]) || t === 'unknown');
    };
    /* Checking if one of the radio siblings is checked */
    isSiblingChecked = function(el) {
        var siblings = document.getElementsByName(el.name);
        for(var i=0; i<siblings.length; i++){
            if(siblings[i].checked){
                return true;
            }
        }
        return false;
    };

    // Since all methods are only used internally no need to expose globally
    return {
        setup: setup
    };

}));

(function(window, undefined) {

  var Cookies = {
    read: function(key, win) {
      var regex = new RegExp('(?:; )?' + encodeURIComponent(key) + '=([^;]*)'),
        cookie = win && win.document && typeof win.document.cookie === 'string' ? win.document.cookie : document.cookie,
        match = cookie.match(regex),
        value = null;

      if (match && match.length > 1) {
        value = match[1];
      }

      return value === null ? null : decodeURIComponent(value);
    },

    write: function(key, value, periodUntilExpiry, path, win, expiryPeriodUnit) {
      var newValue,
          expiresDate = null,
          unit = expiryPeriodUnit || 'days';

      if (typeof periodUntilExpiry === 'number') {
        expiresDate = new Date();
        if (unit === 'days') {
          expiresDate.setDate(expiresDate.getDate() + periodUntilExpiry);
        } else if (unit === 'minutes') {
          expiresDate.setMinutes(expiresDate.getMinutes() + periodUntilExpiry);
        }

      }

      newValue = encodeURIComponent(key) + '=' + encodeURIComponent(value) + (expiresDate ? '; expires=' + expiresDate.toUTCString() : '') + (path && path.length ? '; path=' + path : '');

      if (win && win.document && typeof win.document.cookie === 'string') {
        win.document.cookie = newValue;
      } else {
        document.cookie = newValue;
      }
    }
  };

  // If AMD available
  if ( typeof define === "function" && define.amd ) {
    define( "cookies", [], function () { return Cookies; } );
  // If module exports available for Node / Browserify
  } else if( typeof module === "object" && module && typeof module.exports === "object" ) {
    module.exports = Cookies;
  // Export to the window
  }

  window.Cookies = Cookies;

})(window);
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define([], factory);
    } else {
        // Browser globals
        root.amdWeb = factory(root.b);
    }
}(this, function () {
  var Viewport = { };

  function getViewportDimensions(win) {

    var dimensions = { };

      if (win.innerWidth !== undefined) {
        dimensions.width = win.innerWidth;
        dimensions.height = win.innerHeight;
      } else if (win.document.documentElement !== undefined && win.document.documentElement.clientWidth !== undefined && win.document.documentElement.clientWidth !== 0) {
        dimensions.width = win.document.documentElement.clientWidth,
        dimensions.height = win.document.documentElement.clientHeight
      } else {
        dimensions.width = win.document.getElementsByTagName('body')[0].clientWidth;
        dimensions.height = win.document.getElementsByTagName('body')[0].clientHeight;
      }

    return dimensions;

  };

  Viewport.height = function(win) {

    return getViewportDimensions(win).height;

  };

  Viewport.width = function(win) {

    return getViewportDimensions(win).width;

  }

  return Viewport;

}));

(function (root, factory) {
  if (typeof define === 'function' && define.amd) {
      define(['jquery', 'h5f'], factory);
  } else {
      root.forms = factory(root.jQuery, root.H5F);
  }
}(this, function ($, h5f) {

	  window.document.documentElement.className += ' eva-js-enabled';
    return function(elForms) {
        // Define the classes that are triggered on input
        // valid, invalid, and required events
        for (var i = 0, len = elForms.length; i < len; ++i) {
            h5f.setup(elForms[i], {
                validClass: "valid",
                invalidClass: "invalid",
                requiredClass: "required"
            });
        }

        var $input_elements = $('input, textarea');
        $input_elements.focus(function() {
            $(this).parent().find('.hint').show();
        });

        $input_elements.blur(function() {
            $(this).parent().find('.hint').hide();
        });
    };
}));

(function($){
  $(document).ready(function() {
    $('#helpArrow').remove();
    forms([$('form')[0]]);

    var $btn = $('#sign-up-lower .btn-prev');
    if ($btn.length) {
        var formatPrevButton = function() {
            if (window.innerWidth < 560) {
                $btn.text('<');
            } else {
                $btn.text('Previous Step');
            }
        };

        $(window).on('resize', formatPrevButton);
        formatPrevButton();
    }

  });
}(jQuery));


define(["jquery"],function(b){console.log("module.navigation");var a=function(){console.log("GlobalNav");var f=b("body"),k=b("#hd"),e=b("#nav-global"),d=b("#nav-max"),j=b("#search"),h="fixed",l=26,i={gnOpen:b("#gn-tab"),snOpen:b("#nav-min .navSections a"),searchOpen:b(".navSearch a")},c={fixed:false,gnOpen:false,snOpen:false,searchOpen:false};var m=function(p){if(b(this).scrollTop()>l&&!c.fixed){o(true)}else{if(b(this).scrollTop()<l&&c.fixed){o(false)}}};var o=function(p){var q=(p)?"addClass":"removeClass";c.fixed=p;f[q](h)};var g={go:function(p){if(!c[p]){f.addClass(p);i[p].addClass("on");c[p]=true;b.publish("analytics.interaction",{module:"globalNav",key:p,val:"open"})}else{f.removeClass(p);i[p].removeClass("on");c[p]=false;b.publish("analytics.interaction",{module:"globalNav",key:p,val:"close"})}},global:function(){g.go("gnOpen")},site:function(){g.go("snOpen")},search:function(){g.go("searchOpen")}};var n=function(u,s,q){var r=false,v=[],t;if(u=="snOpen"&&c.gnOpen){r=true;t=e;v.push("global")}else{if(u=="gnOpen"&&c.snOpen){r=true;t=d;v.push("site")}else{if(u=="searchOpen"&&(c.snOpen||c.gnOpen)){r=true;t=(c.snOpen)?d:e;if(c.snOpen){v.push("site")}if(c.gnOpen){v.push("global")}}}}if(u!=="searchOpen"&&c.searchOpen){v.push("search")}if(r){t.one("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",q)}else{q()}var p=v.length;while(p--){g[v[p]]()}};this.init=function(){console.log("GlobalNav.init");b(window).on("scroll",m);i.gnOpen.on("click",function(r){if(!e.length){return}r.preventDefault();n("gnOpen",d,g.global)});i.snOpen.on("click",function(r){if(!d.length){return}r.preventDefault();n("snOpen",e,g.site)});i.searchOpen.on("click",function(r){if(!j.length){return}r.preventDefault();n("searchOpen",d,g.search)});var q=b("a",d),p=false;q.on("click",function(t){var s=b(this);if(s.attr("href")=="#"){t.preventDefault();var r=s.parent("li");if(p){p.removeClass("on")}if(r[0]===p[0]){p=false}else{r.addClass("on");p=r}}});b("#cookie").on("click",".clearCookie",function(r){r.preventDefault();f.removeClass("cookieOpen")});m(b(window))};return{init:this.init}};b(document).ready(function(){a().init()});return a});